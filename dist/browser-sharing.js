(function webpackUniversalModuleDefinition(root, factory) {
	if(typeof exports === 'object' && typeof module === 'object')
		module.exports = factory();
	else if(typeof define === 'function' && define.amd)
		define([], factory);
	else if(typeof exports === 'object')
		exports["BrowserSharing"] = factory();
	else
		root["BrowserSharing"] = factory();
})(window, function() {
return /******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 0);
/******/ })
/************************************************************************/
/******/ ({

/***/ "./node_modules/selector-generator/selector-generator.js":
/*!***************************************************************!*\
  !*** ./node_modules/selector-generator/selector-generator.js ***!
  \***************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("/* selector-generator (ver. 0.3.0). https://github.com/flamencist/SelectorGenerator */\r\n\r\n(function () {\r\n\r\n  \"use strict\";\r\n\r\n  var exports = {};\r\n\r\n  if (!(\"version\" in exports)) {\r\n    exports.version = \"0.3.0\";\r\n  }\r\n\r\n (function(exports){ \r\n  function SelectorGenerator(options){\r\n\r\n\t var shim = {};\r\n\t //noinspection JSUnresolvedVariable\r\n\t var call = Function.call;\r\n\t \r\n\t /**\r\n\t  * wrap function and use first argument as context (this) in returned function\r\n\t  * @param f {Function} function for call\r\n\t  * @returns {Function}\r\n\t  */\r\n\t function uncurryThis(f) {\r\n\t     return function () {\r\n\t         return call.apply(f, arguments);\r\n\t     };\r\n\t }\r\n\t \r\n\t /**\r\n\t  * check function is native\r\n\t  * @param f {Function} function\r\n\t  * @returns {boolean}\r\n\t  */\r\n\t var isFuncNative = function (f) {\r\n\t     return !!f && (typeof f).toLowerCase() === \"function\"\r\n\t         && (f === Function.prototype\r\n\t         || /^\\s*function\\s*(\\b[a-z$_][a-z0-9$_]*\\b)*\\s*\\((|([a-z$_][a-z0-9$_]*)(\\s*,[a-z$_][a-z0-9$_]*)*)\\)\\s*\\{\\s*\\[native code\\]\\s*\\}\\s*$/i.test(String(f)));\r\n\t };\r\n\t \r\n\t /**\r\n\t  *\r\n\t  * @method getFuncNative\r\n\t  * @param fun\r\n\t  * @return {null}\r\n\t  * @private\r\n\t  */\r\n\t var getFuncNative = function (fun) {\r\n\t     return fun && isFuncNative(fun) ? fun : null;\r\n\t };\r\n\t \r\n\t var array_reduce = uncurryThis(\r\n\t     Array.prototype.reduce && isFuncNative(Array.prototype.reduce) ? Array.prototype.reduce : function (callback, basis) {\r\n\t         var index = 0,\r\n\t             length = this.length;\r\n\t         // concerning the initial value, if one is not provided\r\n\t         if (arguments.length === 1) {\r\n\t             // seek to the first value in the array, accounting\r\n\t             // for the possibility that is is a sparse array\r\n\t             do {\r\n\t                 if (index in this) {\r\n\t                     basis = this[index++];\r\n\t                     break;\r\n\t                 }\r\n\t                 if (++index >= length) {\r\n\t                     throw new TypeError();\r\n\t                 }\r\n\t             } while (1);\r\n\t         }\r\n\t         // reduce\r\n\t         for (; index < length; index++) {\r\n\t             // account for the possibility that the array is sparse\r\n\t             if (index in this) {\r\n\t                 basis = callback(basis, this[index], index);\r\n\t             }\r\n\t         }\r\n\t         return basis;\r\n\t     }\r\n\t );\r\n\t \r\n\t var array_map = uncurryThis(\r\n\t     Array.prototype.map && isFuncNative(Array.prototype.map) ? Array.prototype.map : function (callback, thisp) {\r\n\t         var self = this;\r\n\t         var collect = [];\r\n\t         array_reduce(self, function (undefined, value, index) {\r\n\t             collect.push(callback.call(thisp, value, index, self));\r\n\t         }, void 0);\r\n\t         return collect;\r\n\t     }\r\n\t );\r\n\t \r\n\t var array_filter = uncurryThis(\r\n\t     Array.prototype.filter && isFuncNative(Array.prototype.filter) ? Array.prototype.filter :\r\n\t         function (predicate, that) {\r\n\t             var other = [], v;\r\n\t             for (var i = 0, n = this.length; i < n; i++) {\r\n\t                 if (i in this && predicate.call(that, v = this[i], i, this)) {\r\n\t                     other.push(v);\r\n\t                 }\r\n\t             }\r\n\t             return other;\r\n\t         }\r\n\t );\r\n\t \r\n\t /**\r\n\t  * shim for array.indexOf\r\n\t  *\r\n\t  * @function array_indexOf\r\n\t  * @example\r\n\t  *  ```\r\n\t  *      var arr = [2,3,4];\r\n\t  *      var result = arrayUtils.indexOf(arr, 3);\r\n\t  *      console.log(result);\r\n\t  *  ```\r\n\t  *    *result: 1*\r\n\t  * @type {Function}\r\n\t  * @private\r\n\t  */\r\n\t var array_indexOf = uncurryThis(getFuncNative(Array.prototype.indexOf) ||\r\n\t     function (searchElement, fromIndex) {\r\n\t         var k;\r\n\t \r\n\t         if (!this || !this.length) {//eslint-disable-line no-invalid-this\r\n\t             throw new TypeError(\"\\\"this\\\" is null or not defined\");\r\n\t         }\r\n\t \r\n\t         var O = Object(this);//eslint-disable-line no-invalid-this\r\n\t \r\n\t         var len = O.length >>> 0;\r\n\t \r\n\t         if (len === 0) {\r\n\t             return -1;\r\n\t         }\r\n\t \r\n\t         var n = +fromIndex || 0;\r\n\t \r\n\t         if (Math.abs(n) === Infinity) {\r\n\t             n = 0;\r\n\t         }\r\n\t \r\n\t         if (n >= len) {\r\n\t             return -1;\r\n\t         }\r\n\t \r\n\t         k = Math.max(n >= 0 ? n : len - Math.abs(n), 0);\r\n\t \r\n\t         while (k < len) {\r\n\t             if (k in O && O[k] === searchElement) {\r\n\t                 return k;\r\n\t             }\r\n\t             k++;\r\n\t         }\r\n\t         return -1;\r\n\t     });\r\n\t \r\n\t /**\r\n\t  * array find shim\r\n\t  *\r\n\t  * @function array_find\r\n\t  * @example\r\n\t  *  ```\r\n\t  *      var arr = [2,3,4];\r\n\t  *      var result = arrayUtils.find(arr, function(item){\r\n\t          *          return item % 2 === 0;\r\n\t          *      });\r\n\t  *      console.log(result);\r\n\t  *  ```\r\n\t  *    *result: 2*\r\n\t  * @type {Function}\r\n\t  * @private\r\n\t  */\r\n\t var array_find = uncurryThis(getFuncNative(Array.prototype.find) ||\r\n\t     function (predicate, that) {\r\n\t         var length = this.length;//eslint-disable-line no-invalid-this\r\n\t         if (typeof predicate !== \"function\") {\r\n\t             throw new TypeError(\"Array#find: predicate must be a function\");\r\n\t         }\r\n\t         if (length === 0) {\r\n\t             return undefined;\r\n\t         }\r\n\t         for (var i = 0, value; i < length; i++) {\r\n\t             value = this[i];//eslint-disable-line no-invalid-this\r\n\t             if (predicate.call(that, value, i, this)) {\r\n\t                 return value;\r\n\t             }\r\n\t         }\r\n\t         return undefined;\r\n\t     }\r\n\t );\r\n\t \r\n\t shim.reduce = array_reduce;\r\n\t shim.map = array_map;\r\n\t shim.filter = array_filter;\r\n\t shim.indexOf = array_indexOf;\r\n\t shim.find = array_find;\r\n\t \r\n\t var _ = shim; //eslint-disable-line no-unused-vars\r\n\t exports._  = shim;\r\n\r\n\t var autogenRegexps = [\r\n\t     /\\d{4,}/,\r\n\t     /^ember\\d+/,\r\n\t     /^[0-9_-]+$/,\r\n\t     /^_\\d{2,}/,\r\n\t     /([a-f_-]*[0-9_-]){6,}/i\r\n\t ];\r\n\t \r\n\t /**\r\n\t  * check auto-generated selectors\r\n\t  * @param {String} val\r\n\t  * @return {boolean} is auto-generated\r\n\t  */\r\n\t function autogenCheck(val){\r\n\t     if(!val){\r\n\t         return false;\r\n\t     }\r\n\t     var autogenerated = _.find(autogenRegexps,function(reg){\r\n\t         return reg.test(val);\r\n\t     });\r\n\t     return !!autogenerated;\r\n\t \r\n\t }\r\n\t exports.autogenCheck = autogenCheck;\r\n\t \r\n\r\n\t var cssEscaper = (function(){\r\n\t     /**\r\n\t      * @function escapeIdentifierIfNeeded\r\n\t      * @param {string} ident\r\n\t      * @return {string}\r\n\t      */\r\n\t     function escapeIdentifierIfNeeded(ident) {\r\n\t         if (isCssIdentifier(ident)) {\r\n\t             return ident;\r\n\t         }\r\n\t         var shouldEscapeFirst = /^(?:[0-9]|-[0-9-]?)/.test(ident);\r\n\t         var lastIndex = ident.length - 1;\r\n\t         return ident.replace(/./g, function (c, i) {\r\n\t             return ((shouldEscapeFirst && i === 0) || !isCssIdentChar(c)) ? escapeAsciiChar(c, i === lastIndex) : c;\r\n\t         });\r\n\t     }\r\n\t \r\n\t     /**\r\n\t      * @function escapeAsciiChar\r\n\t      * @param {string} c\r\n\t      * @param {boolean} isLast\r\n\t      * @return {string}\r\n\t      */\r\n\t     function escapeAsciiChar(c, isLast) {\r\n\t         return \"\\\\\" + toHexByte(c) + (isLast ? \"\" : \" \");\r\n\t     }\r\n\t \r\n\t     /**\r\n\t      * @function toHexByte\r\n\t      * @param {string} c\r\n\t      */\r\n\t     function toHexByte(c) {\r\n\t         var hexByte = c.charCodeAt(0).toString(16);\r\n\t         if (hexByte.length === 1) {\r\n\t             hexByte = \"0\" + hexByte;\r\n\t         }\r\n\t         return hexByte;\r\n\t     }\r\n\t \r\n\t     /**\r\n\t      * @function isCssIdentChar\r\n\t      * @param {string} c\r\n\t      * @return {boolean}\r\n\t      */\r\n\t     function isCssIdentChar(c) {\r\n\t         if (/[a-zA-Z0-9_-]/.test(c)) {\r\n\t             return true;\r\n\t         }\r\n\t         return c.charCodeAt(0) >= 0xA0;\r\n\t     }\r\n\t \r\n\t     /**\r\n\t      * @function isCssIdentifier\r\n\t      * @param {string} value\r\n\t      * @return {boolean}\r\n\t      */\r\n\t     function isCssIdentifier(value) {\r\n\t         return /^-?[a-zA-Z_][a-zA-Z0-9_-]*$/.test(value);\r\n\t     }\r\n\t \r\n\t     return {escape : escapeIdentifierIfNeeded};\r\n\t \r\n\t })();\r\n\t \r\n\t exports.cssEscaper = cssEscaper;\r\n\t \r\n\r\n\t /**\r\n\t  * @constructor\r\n\t  * @param {string} value\r\n\t  * @param {boolean} optimized\r\n\t  */\r\n\t var DomNodePathStep = function (value, optimized) {\r\n\t     this.value = value;\r\n\t     this.optimized = optimized || false;\r\n\t };\r\n\t \r\n\t DomNodePathStep.prototype = {\r\n\t     /**\r\n\t      * @return {string}\r\n\t      */\r\n\t     toString: function () {\r\n\t         return this.value;\r\n\t     }\r\n\t };\r\n\t \r\n\t exports.DomNodePathStep = DomNodePathStep;\r\n\t \r\n\r\n\t /* globals DomNodePathStep, cssEscaper, autogenCheck */ //eslint-disable-line no-unused-vars\r\n\t /**\r\n\t  * @param {Object?} options\r\n\t  * @param {boolean?} options.withoutNthChild\r\n\t  * @param {boolean?} options.optimized\r\n\t  * @param {Node?} options.targetNode\r\n\t  * @class\r\n\t  * @constructor\r\n\t  */\r\n\t function SelectorGeneratorStep(options) {\r\n\t     options = options || {\r\n\t             withoutNthChild: false,\r\n\t             targetNode: null\r\n\t         };\r\n\t \r\n\t     /**\r\n\t      * generate selector for current node\r\n\t      * @param {HTMLElement} node\r\n\t      * @return {DomNodePathStep} selector for current node\r\n\t      */\r\n\t     this.visit = function (node) {\r\n\t         if (node.nodeType !== 1) {\r\n\t             return null;\r\n\t         }\r\n\t \r\n\t         var nodeName = node.nodeName.toLowerCase();\r\n\t         var parent = node.parentNode;\r\n\t         var siblings = parent.children || [];\r\n\t         var siblingsWithSameNodeName = getSiblingsWithSameNodeName(node, siblings);\r\n\t \r\n\t         var needsId = hasId(node, siblingsWithSameNodeName);\r\n\t         if (needsId) {\r\n\t             var id = node.getAttribute(\"id\");\r\n\t             return new DomNodePathStep(nodeName + idSelector(id), true);\r\n\t         }\r\n\t         var isRootNode = !parent || parent.nodeType === 9;\r\n\t         if (isRootNode) // document node\r\n\t         {\r\n\t             return new DomNodePathStep(nodeName, true);\r\n\t         }\r\n\t \r\n\t         var hasAttributeName = hasUniqueAttributeName(node,siblingsWithSameNodeName);\r\n\t         var needsClassNames = siblingsWithSameNodeName.length > 0;\r\n\t         var needsNthChild = isNeedsNthChild(node, siblingsWithSameNodeName, hasAttributeName);\r\n\t         var needsType = hasType(node);\r\n\t \r\n\t         var result = nodeName;\r\n\t \r\n\t         if (hasAttributeName) {\r\n\t             var attributeName = node.getAttribute(\"name\");\r\n\t             result += \"[name=\\\"\" + cssEscaper.escape(attributeName) + \"\\\"]\";\r\n\t             return new DomNodePathStep(result, true);\r\n\t         }\r\n\t \r\n\t         if (needsType) {\r\n\t             result += \"[type=\\\"\" + node.getAttribute(\"type\") + \"\\\"]\";\r\n\t         }\r\n\t \r\n\t         if (needsNthChild && !options.withoutNthChild) {\r\n\t             var ownIndex = _.indexOf(siblings, node);\r\n\t             result += \":nth-child(\" + (ownIndex + 1) + \")\";\r\n\t         } else if (needsClassNames) {\r\n\t             var prefixedOwnClassNamesArray = prefixedElementClassNames(node);\r\n\t             for (var prefixedName in keySet(prefixedOwnClassNamesArray)) { //eslint-disable-line guard-for-in\r\n\t                 result += \".\" + cssEscaper.escape(prefixedName.substr(1));\r\n\t             }\r\n\t         }\r\n\t \r\n\t         return new DomNodePathStep(result, false);\r\n\t     };\r\n\t \r\n\t     function hasUniqueAttributeName(node, siblingsWithSameNodeName){\r\n\t         var attributeName = node.getAttribute(\"name\");\r\n\t         if(!attributeName || autogenCheck(attributeName)){\r\n\t             return false;\r\n\t         }\r\n\t         var isSimpleFormElement = isSimpleInput(node, options.targetNode === node) || isFormWithoutId(node);\r\n\t         return !!(isSimpleFormElement && attributeName && !_.find(siblingsWithSameNodeName,function(sibling){\r\n\t             return sibling.getAttribute(\"name\") === attributeName;\r\n\t         }));\r\n\t     }\r\n\t \r\n\t     function isNeedsNthChild(node, siblings, isUniqueAttributeName) {\r\n\t         var needsNthChild = false;\r\n\t         var prefixedOwnClassNamesArray = prefixedElementClassNames(node);\r\n\t         for (var i = 0; (!needsNthChild) && i < siblings.length; ++i) {\r\n\t             var sibling = siblings[i];\r\n\t             if (needsNthChild) {\r\n\t                 continue;\r\n\t             }\r\n\t \r\n\t             var ownClassNames = keySet(prefixedOwnClassNamesArray);\r\n\t             var ownClassNameCount = 0;\r\n\t \r\n\t             for (var name in ownClassNames) {\r\n\t                 if (ownClassNames.hasOwnProperty(name)) {\r\n\t                     ++ownClassNameCount;\r\n\t                 }\r\n\t             }\r\n\t             if (ownClassNameCount === 0 && !isUniqueAttributeName) {\r\n\t                 needsNthChild = true;\r\n\t                 continue;\r\n\t             }\r\n\t             var siblingClassNamesArray = prefixedElementClassNames(sibling);\r\n\t \r\n\t             for (var j = 0; j < siblingClassNamesArray.length; ++j) {\r\n\t                 var siblingClass = siblingClassNamesArray[j];\r\n\t                 if (!ownClassNames.hasOwnProperty(siblingClass)) {\r\n\t                     continue;\r\n\t                 }\r\n\t                 delete ownClassNames[siblingClass];\r\n\t                 if (!--ownClassNameCount && !isUniqueAttributeName) {\r\n\t                     needsNthChild = true;\r\n\t                     break;\r\n\t                 }\r\n\t             }\r\n\t         }\r\n\t         return needsNthChild;\r\n\t     }\r\n\t \r\n\t     function getSiblingsWithSameNodeName(node, siblings) {\r\n\t         return _.filter(siblings, function (sibling) {\r\n\t             return sibling.nodeType === 1 && sibling !== node && sibling.nodeName.toLowerCase() === node.nodeName.toLowerCase();\r\n\t         });\r\n\t     }\r\n\t \r\n\t     function hasType(node) {\r\n\t         return node.getAttribute(\"type\") && ( (isSimpleInput(node, options.targetNode === node) && !getClassName(node)) || isFormWithoutId(node) || isButtonWithoutId(node));\r\n\t     }\r\n\t \r\n\t     /**\r\n\t      * @function idSelector\r\n\t      * @param {string} id\r\n\t      * @return {string}\r\n\t      */\r\n\t     function idSelector(id) {\r\n\t         return \"#\" + cssEscaper.escape(id);\r\n\t     }\r\n\t \r\n\t     /**\r\n\t      * element has siblings with same id and same tag\r\n\t      * @function hasId\r\n\t      * @param {Element} node\r\n\t      * @param {Array<Element>} siblings Array of elements , parent.children\r\n\t      * @return {boolean}\r\n\t      */\r\n\t     function hasId(node, siblings) {\r\n\t         var id = node.getAttribute(\"id\");\r\n\t         if(!id){\r\n\t             return false;\r\n\t         }\r\n\t         if(autogenCheck(id)){\r\n\t             return false;\r\n\t         }\r\n\t         return _.filter(siblings, function (s) {\r\n\t                 return s.getAttribute(\"id\") === id;\r\n\t             }).length === 0;\r\n\t     }\r\n\t \r\n\t     /**\r\n\t      * @function keySet\r\n\t      * @param {Array} array of keys\r\n\t      * @return {Object}\r\n\t      */\r\n\t     function keySet(array) {\r\n\t         var keys = {};\r\n\t         for (var i = 0; i < array.length; ++i) {\r\n\t             keys[array[i]] = true;\r\n\t         }\r\n\t         return keys;\r\n\t     }\r\n\t \r\n\t     /**\r\n\t      * @function prefixedElementClassNames\r\n\t      * @param {HTMLElement} node\r\n\t      * @return {!Array.<string>}\r\n\t      */\r\n\t     function prefixedElementClassNames(node) {\r\n\t         var classAttribute = getClassName(node);\r\n\t         if (!classAttribute) {\r\n\t             return [];\r\n\t         }\r\n\t \r\n\t         var classes = classAttribute.split(/\\s+/g);\r\n\t         var existClasses = _.filter(classes, function(c){\r\n\t             return c && !autogenCheck(c);\r\n\t         });\r\n\t         return _.map(existClasses, function (name) {\r\n\t             // The prefix is required to store \"__proto__\" in a object-based map.\r\n\t             return \"$\" + name;\r\n\t         });\r\n\t     }\r\n\t \r\n\t     function isFormWithoutId(node) {\r\n\t         return node.nodeName.toLowerCase() === \"form\" && !node.getAttribute(\"id\");\r\n\t     }\r\n\t \r\n\t     function isButtonWithoutId(node) {\r\n\t         return node.nodeName.toLowerCase() === \"button\" && !node.getAttribute(\"id\");\r\n\t     }\r\n\t \r\n\t     /**\r\n\t      * target is simple input without classes,id\r\n\t      * @function isSimpleInput\r\n\t      * @param node\r\n\t      * @param isTargetNode\r\n\t      * @return {boolean}\r\n\t      */\r\n\t     function isSimpleInput(node, isTargetNode) {\r\n\t         return isTargetNode && node.nodeName.toLowerCase() === \"input\" ;\r\n\t     }\r\n\t \r\n\t     /**\r\n\t      * @function getClassName\r\n\t      * get css class of element\r\n\t      * @param {HTMLElement} node Web element\r\n\t      * @return {string}\r\n\t      */\r\n\t     function getClassName(node) {\r\n\t         return node.getAttribute(\"class\") || node.className;\r\n\t     }\r\n\t \r\n\t }\r\n\t \r\n\t exports.SelectorGeneratorStep = SelectorGeneratorStep;\r\n\t \r\n\r\n\t /*global  SelectorGeneratorStep */ //eslint-disable-line no-unused-vars\r\n\t /**\r\n\t  * @class\r\n\t  * get unique selector, path of node\r\n\t  * @param {Object?} options\r\n\t  * @param {function?} options.querySelectorAll\r\n\t  * @constructor\r\n\t  */\r\n\t function SelectorGenerator(options) { //eslint-disable-line no-unused-vars\r\n\t \r\n\t     options = options || {};\r\n\t \r\n\t     /**\r\n\t      * @description get full path of node\r\n\t      * @function getPath\r\n\t      * @param {HTMLElement} node\r\n\t      * @return {string}\r\n\t      */\r\n\t     function getPath(node) {\r\n\t         if (!node || node.nodeType !== 1) {\r\n\t             return \"\";\r\n\t         }\r\n\t         var selectorGeneratorStep = new SelectorGeneratorStep({\r\n\t             withoutNthChild: true,\r\n\t             targetNode: node\r\n\t         });\r\n\t         var steps = [];\r\n\t         var contextNode = node;\r\n\t         while (contextNode) {\r\n\t             var step = selectorGeneratorStep.visit(contextNode);\r\n\t             if (!step) {\r\n\t                 break;\r\n\t             } // Error - bail out early.\r\n\t             steps.push(step);\r\n\t             contextNode = contextNode.parentNode;\r\n\t         }\r\n\t \r\n\t         steps.reverse();\r\n\t         return steps.join(\" \");\r\n\t     }\r\n\t \r\n\t     /**\r\n\t      * @param {HTMLElement} node\r\n\t      * @return {string}\r\n\t      */\r\n\t     function getSelector(node) {\r\n\t         if (!node || node.nodeType !== 1) {\r\n\t             return \"\";\r\n\t         }\r\n\t         var selectorGeneratorStep = new SelectorGeneratorStep({targetNode: node});\r\n\t         var steps = [];\r\n\t         var contextNode = node;\r\n\t         while (contextNode) {\r\n\t             var step = selectorGeneratorStep.visit(contextNode);\r\n\t             if (!step) {\r\n\t                 break; // Error - bail out early.\r\n\t             }\r\n\t             steps.push(step);\r\n\t             if (step.optimized) {\r\n\t                 if (isUniqueSelector(buildSelector(steps))) {\r\n\t                     break;\r\n\t                 }\r\n\t             }\r\n\t             contextNode = contextNode.parentNode;\r\n\t         }\r\n\t \r\n\t         var simplifiedSteps = simplifySelector(steps);\r\n\t         return buildSelector(simplifiedSteps);\r\n\t     }\r\n\t \r\n\t     /**\r\n\t      * simplify selector\r\n\t      * @example\r\n\t      * ```\r\n\t      *  <div>\r\n\t      *      <div>\r\n\t      *          <form>\r\n\t      *              <input type=\"text\"/>\r\n\t      *          </form>\r\n\t      *      </div>\r\n\t      *  </div>\r\n\t      *\r\n\t      * var steps = [new DomNodePathStep(\"input[type='text']\"), new DomNodePathStep(\"form\"), new DomNodePathStep(\"div\"), new DomNodePathStep(\"div\")];\r\n\t      * var simplified = simplifySelector(steps); // [\"input[type='text']\", \"form\"]\r\n\t      * ```\r\n\t      *\r\n\t      * @example\r\n\t      * ```\r\n\t      *  <div id=\"loginForm\">\r\n\t      *      <div>\r\n\t      *          <div>\r\n\t      *              <input type=\"text\"/>\r\n\t      *          </div>\r\n\t      *      </div>\r\n\t      *  </div>\r\n\t      *\r\n\t      * var steps = [new DomNodePathStep(\"input[type='text']\"), new DomNodePathStep(\"div\"), new DomNodePathStep(\"div\"), new DomNodePathStep(\"div#loginForm\")];\r\n\t      * var simplified = simplifySelector(steps); // [[\"input[type='text']\"],[\"div#loginForm\"]]\r\n\t      * ```\r\n\t      *\r\n\t      * @method simplifySelector\r\n\t      * @param {Array} steps parts of selector\r\n\t      * @return {Array} steps array of steps or array Arrays of steps\r\n\t      */\r\n\t     function simplifySelector(steps) {\r\n\t         var minLength = 2;\r\n\t         //if count of selectors is little, that not modify selector\r\n\t         if (steps.length <= minLength) {\r\n\t             return steps;\r\n\t         }\r\n\t \r\n\t         var stepsCopy = steps.slice();\r\n\t         removeHtmlBodySteps(stepsCopy);\r\n\t \r\n\t         var lastStep = stepsCopy[stepsCopy.length - 1];\r\n\t         var parentWithId = lastStep.toString().indexOf(\"#\") >= 0;\r\n\t         var parentWithName = lastStep.toString().indexOf(\"name=\") >= 0;\r\n\t \r\n\t         if (parentWithId || parentWithName) {\r\n\t             return simplifyStepsWithParent(stepsCopy);\r\n\t         } else {\r\n\t             return regularSimplifySteps(stepsCopy, minLength);\r\n\t         }\r\n\t     }\r\n\t \r\n\t     /**\r\n\t      * remove Html, Body Steps\r\n\t      * @param steps\r\n\t      */\r\n\t     function removeHtmlBodySteps(steps) {\r\n\t         while (steps[steps.length - 1].toString() === \"html\" || steps[steps.length - 1].toString() === \"body\") {\r\n\t             steps.pop();\r\n\t         }\r\n\t     }\r\n\t \r\n\t     /**\r\n\t      *  simplifyStepsWithParent\r\n\t      * @function simplifyStepsWithParent\r\n\t      * @param steps\r\n\t      * @return {Array} array of arrays\r\n\t      */\r\n\t     function simplifyStepsWithParent(steps) {\r\n\t         var parentStep = steps.slice(-1);\r\n\t         var sliced = steps.slice(0, 1);\r\n\t         while (sliced.length < (steps.length - 1)) {\r\n\t             var selector = buildSelector([sliced, parentStep]);\r\n\t             if (isUniqueSelector(selector)) {\r\n\t                 break;\r\n\t             }\r\n\t             sliced = steps.slice(0, sliced.length + 1);\r\n\t         }\r\n\t         return [sliced, parentStep];\r\n\t     }\r\n\t \r\n\t     /**\r\n\t      * regularSimplifySteps\r\n\t      * @method regularSimplifySteps\r\n\t      * @param {Array} steps\r\n\t      * @param {int=2} minLength\r\n\t      * @return {Array} array of steps\r\n\t      */\r\n\t     function regularSimplifySteps(steps, minLength) {\r\n\t         minLength = minLength || 2;\r\n\t         var sliced = steps.slice(0, minLength);\r\n\t         while (sliced.length < steps.length) {\r\n\t             var selector = buildSelector(sliced);\r\n\t             if (isUniqueSelector(selector)) {\r\n\t                 break;\r\n\t             }\r\n\t             sliced = steps.slice(0, sliced.length + 1);\r\n\t         }\r\n\t         return sliced;\r\n\t     }\r\n\t \r\n\t     /**\r\n\t      * create selector string from steps array\r\n\t      * @function buildSelector\r\n\t      * @example\r\n\t      * with single array of steps\r\n\t      * ```\r\n\t      * <form id=\"loginForm\">\r\n\t      *    <input type='text'/>\r\n\t      * </form>\r\n\t      *\r\n\t      *  var steps = [new DomNodePathStep(\"input[type='text']\"),new DomNodePathStep(\"form#loginForm\")];\r\n\t      *  var selector = buildSelector(steps); // \"form#loginForm > input[type='text']\"\r\n\t      * ```\r\n\t      *\r\n\t      * @example\r\n\t      * with multiple array of steps\r\n\t      * ```\r\n\t      * <div id=\"loginForm\">\r\n\t      *    <div>\r\n\t      *       <div>\r\n\t      *          <input type='text'/>\r\n\t      *      </div>\r\n\t      *   </div>\r\n\t      *  </div>\r\n\t      *\r\n\t      * var steps = [[new DomNodePathStep(\"input[type='text']\")],[new DomNodePathStep(\"div#loginForm\")]];\r\n\t      * var selector = buildSelector(steps); // \"div#loginForm input[type='text']\"\r\n\t      * ```\r\n\t      *\r\n\t      * @param {Array} steps Array of string or array of Array of string\r\n\t      * @return {string} selector string\r\n\t      */\r\n\t     function buildSelector(steps) {\r\n\t         var stepsCopy = steps.slice();\r\n\t         stepsCopy.reverse();\r\n\t         //check steps is regular array of steps\r\n\t         if (typeof(stepsCopy[0].value) !== \"undefined\") {\r\n\t             return stepsCopy.join(\" > \");\r\n\t         } else {\r\n\t             return _.reduce(stepsCopy, function (previosValue, currentValue) {\r\n\t                 var selector = buildSelector(currentValue);\r\n\t                 return previosValue ? previosValue + \" \" + selector : selector;\r\n\t             }, \"\");\r\n\t         }\r\n\t     }\r\n\t \r\n\t     /**\r\n\t      * @function isUniqueSelector\r\n\t      * detect selector is unique\r\n\t      * @param {String} selector\r\n\t      * @return {boolean} unique selector?\r\n\t      */\r\n\t     function isUniqueSelector(selector) {\r\n\t         if (!options.querySelectorAll) {\r\n\t             return true;\r\n\t         }\r\n\t         return options.querySelectorAll(selector).length < 2;\r\n\t     }\r\n\t \r\n\t     /**\r\n\t      * get unique selector\r\n\t      * @method\r\n\t      * @param {HTMLElement} node html element\r\n\t      * @param {boolean?} optimized get short selector\r\n\t      * @returns {String} selector\r\n\t      */\r\n\t     this.getSelector = getSelector;\r\n\t     /**\r\n\t      * path of node\r\n\t      * @method\r\n\t      * @param {HTMLElement} node html element\r\n\t      * @returns {String} path\r\n\t      */\r\n\t     this.getPath = getPath;\r\n\t }\r\n\t \r\n\t exports.SelectorGenerator = SelectorGenerator;\r\n\r\n  return new SelectorGenerator(options);\r\n }\r\n  exports.SelectorGenerator = SelectorGenerator;\r\n } (exports));\r\n\r\nfor(var key in exports){ if(exports.hasOwnProperty(key)){ exports.SelectorGenerator[key] = exports[key]; }}\r\n window.SelectorGenerator = exports.SelectorGenerator;\r\n\r\n} ());\r\n\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvc2VsZWN0b3ItZ2VuZXJhdG9yL3NlbGVjdG9yLWdlbmVyYXRvci5qcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovL0Jyb3dzZXJTaGFyaW5nLy4vbm9kZV9tb2R1bGVzL3NlbGVjdG9yLWdlbmVyYXRvci9zZWxlY3Rvci1nZW5lcmF0b3IuanM/NTQxOSJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiBzZWxlY3Rvci1nZW5lcmF0b3IgKHZlci4gMC4zLjApLiBodHRwczovL2dpdGh1Yi5jb20vZmxhbWVuY2lzdC9TZWxlY3RvckdlbmVyYXRvciAqL1xyXG5cclxuKGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gIHZhciBleHBvcnRzID0ge307XHJcblxyXG4gIGlmICghKFwidmVyc2lvblwiIGluIGV4cG9ydHMpKSB7XHJcbiAgICBleHBvcnRzLnZlcnNpb24gPSBcIjAuMy4wXCI7XHJcbiAgfVxyXG5cclxuIChmdW5jdGlvbihleHBvcnRzKXsgXHJcbiAgZnVuY3Rpb24gU2VsZWN0b3JHZW5lcmF0b3Iob3B0aW9ucyl7XHJcblxyXG5cdCB2YXIgc2hpbSA9IHt9O1xyXG5cdCAvL25vaW5zcGVjdGlvbiBKU1VucmVzb2x2ZWRWYXJpYWJsZVxyXG5cdCB2YXIgY2FsbCA9IEZ1bmN0aW9uLmNhbGw7XHJcblx0IFxyXG5cdCAvKipcclxuXHQgICogd3JhcCBmdW5jdGlvbiBhbmQgdXNlIGZpcnN0IGFyZ3VtZW50IGFzIGNvbnRleHQgKHRoaXMpIGluIHJldHVybmVkIGZ1bmN0aW9uXHJcblx0ICAqIEBwYXJhbSBmIHtGdW5jdGlvbn0gZnVuY3Rpb24gZm9yIGNhbGxcclxuXHQgICogQHJldHVybnMge0Z1bmN0aW9ufVxyXG5cdCAgKi9cclxuXHQgZnVuY3Rpb24gdW5jdXJyeVRoaXMoZikge1xyXG5cdCAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcclxuXHQgICAgICAgICByZXR1cm4gY2FsbC5hcHBseShmLCBhcmd1bWVudHMpO1xyXG5cdCAgICAgfTtcclxuXHQgfVxyXG5cdCBcclxuXHQgLyoqXHJcblx0ICAqIGNoZWNrIGZ1bmN0aW9uIGlzIG5hdGl2ZVxyXG5cdCAgKiBAcGFyYW0gZiB7RnVuY3Rpb259IGZ1bmN0aW9uXHJcblx0ICAqIEByZXR1cm5zIHtib29sZWFufVxyXG5cdCAgKi9cclxuXHQgdmFyIGlzRnVuY05hdGl2ZSA9IGZ1bmN0aW9uIChmKSB7XHJcblx0ICAgICByZXR1cm4gISFmICYmICh0eXBlb2YgZikudG9Mb3dlckNhc2UoKSA9PT0gXCJmdW5jdGlvblwiXHJcblx0ICAgICAgICAgJiYgKGYgPT09IEZ1bmN0aW9uLnByb3RvdHlwZVxyXG5cdCAgICAgICAgIHx8IC9eXFxzKmZ1bmN0aW9uXFxzKihcXGJbYS16JF9dW2EtejAtOSRfXSpcXGIpKlxccypcXCgofChbYS16JF9dW2EtejAtOSRfXSopKFxccyosW2EteiRfXVthLXowLTkkX10qKSopXFwpXFxzKlxce1xccypcXFtuYXRpdmUgY29kZVxcXVxccypcXH1cXHMqJC9pLnRlc3QoU3RyaW5nKGYpKSk7XHJcblx0IH07XHJcblx0IFxyXG5cdCAvKipcclxuXHQgICpcclxuXHQgICogQG1ldGhvZCBnZXRGdW5jTmF0aXZlXHJcblx0ICAqIEBwYXJhbSBmdW5cclxuXHQgICogQHJldHVybiB7bnVsbH1cclxuXHQgICogQHByaXZhdGVcclxuXHQgICovXHJcblx0IHZhciBnZXRGdW5jTmF0aXZlID0gZnVuY3Rpb24gKGZ1bikge1xyXG5cdCAgICAgcmV0dXJuIGZ1biAmJiBpc0Z1bmNOYXRpdmUoZnVuKSA/IGZ1biA6IG51bGw7XHJcblx0IH07XHJcblx0IFxyXG5cdCB2YXIgYXJyYXlfcmVkdWNlID0gdW5jdXJyeVRoaXMoXHJcblx0ICAgICBBcnJheS5wcm90b3R5cGUucmVkdWNlICYmIGlzRnVuY05hdGl2ZShBcnJheS5wcm90b3R5cGUucmVkdWNlKSA/IEFycmF5LnByb3RvdHlwZS5yZWR1Y2UgOiBmdW5jdGlvbiAoY2FsbGJhY2ssIGJhc2lzKSB7XHJcblx0ICAgICAgICAgdmFyIGluZGV4ID0gMCxcclxuXHQgICAgICAgICAgICAgbGVuZ3RoID0gdGhpcy5sZW5ndGg7XHJcblx0ICAgICAgICAgLy8gY29uY2VybmluZyB0aGUgaW5pdGlhbCB2YWx1ZSwgaWYgb25lIGlzIG5vdCBwcm92aWRlZFxyXG5cdCAgICAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAxKSB7XHJcblx0ICAgICAgICAgICAgIC8vIHNlZWsgdG8gdGhlIGZpcnN0IHZhbHVlIGluIHRoZSBhcnJheSwgYWNjb3VudGluZ1xyXG5cdCAgICAgICAgICAgICAvLyBmb3IgdGhlIHBvc3NpYmlsaXR5IHRoYXQgaXMgaXMgYSBzcGFyc2UgYXJyYXlcclxuXHQgICAgICAgICAgICAgZG8ge1xyXG5cdCAgICAgICAgICAgICAgICAgaWYgKGluZGV4IGluIHRoaXMpIHtcclxuXHQgICAgICAgICAgICAgICAgICAgICBiYXNpcyA9IHRoaXNbaW5kZXgrK107XHJcblx0ICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcblx0ICAgICAgICAgICAgICAgICB9XHJcblx0ICAgICAgICAgICAgICAgICBpZiAoKytpbmRleCA+PSBsZW5ndGgpIHtcclxuXHQgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCk7XHJcblx0ICAgICAgICAgICAgICAgICB9XHJcblx0ICAgICAgICAgICAgIH0gd2hpbGUgKDEpO1xyXG5cdCAgICAgICAgIH1cclxuXHQgICAgICAgICAvLyByZWR1Y2VcclxuXHQgICAgICAgICBmb3IgKDsgaW5kZXggPCBsZW5ndGg7IGluZGV4KyspIHtcclxuXHQgICAgICAgICAgICAgLy8gYWNjb3VudCBmb3IgdGhlIHBvc3NpYmlsaXR5IHRoYXQgdGhlIGFycmF5IGlzIHNwYXJzZVxyXG5cdCAgICAgICAgICAgICBpZiAoaW5kZXggaW4gdGhpcykge1xyXG5cdCAgICAgICAgICAgICAgICAgYmFzaXMgPSBjYWxsYmFjayhiYXNpcywgdGhpc1tpbmRleF0sIGluZGV4KTtcclxuXHQgICAgICAgICAgICAgfVxyXG5cdCAgICAgICAgIH1cclxuXHQgICAgICAgICByZXR1cm4gYmFzaXM7XHJcblx0ICAgICB9XHJcblx0ICk7XHJcblx0IFxyXG5cdCB2YXIgYXJyYXlfbWFwID0gdW5jdXJyeVRoaXMoXHJcblx0ICAgICBBcnJheS5wcm90b3R5cGUubWFwICYmIGlzRnVuY05hdGl2ZShBcnJheS5wcm90b3R5cGUubWFwKSA/IEFycmF5LnByb3RvdHlwZS5tYXAgOiBmdW5jdGlvbiAoY2FsbGJhY2ssIHRoaXNwKSB7XHJcblx0ICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG5cdCAgICAgICAgIHZhciBjb2xsZWN0ID0gW107XHJcblx0ICAgICAgICAgYXJyYXlfcmVkdWNlKHNlbGYsIGZ1bmN0aW9uICh1bmRlZmluZWQsIHZhbHVlLCBpbmRleCkge1xyXG5cdCAgICAgICAgICAgICBjb2xsZWN0LnB1c2goY2FsbGJhY2suY2FsbCh0aGlzcCwgdmFsdWUsIGluZGV4LCBzZWxmKSk7XHJcblx0ICAgICAgICAgfSwgdm9pZCAwKTtcclxuXHQgICAgICAgICByZXR1cm4gY29sbGVjdDtcclxuXHQgICAgIH1cclxuXHQgKTtcclxuXHQgXHJcblx0IHZhciBhcnJheV9maWx0ZXIgPSB1bmN1cnJ5VGhpcyhcclxuXHQgICAgIEFycmF5LnByb3RvdHlwZS5maWx0ZXIgJiYgaXNGdW5jTmF0aXZlKEFycmF5LnByb3RvdHlwZS5maWx0ZXIpID8gQXJyYXkucHJvdG90eXBlLmZpbHRlciA6XHJcblx0ICAgICAgICAgZnVuY3Rpb24gKHByZWRpY2F0ZSwgdGhhdCkge1xyXG5cdCAgICAgICAgICAgICB2YXIgb3RoZXIgPSBbXSwgdjtcclxuXHQgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIG4gPSB0aGlzLmxlbmd0aDsgaSA8IG47IGkrKykge1xyXG5cdCAgICAgICAgICAgICAgICAgaWYgKGkgaW4gdGhpcyAmJiBwcmVkaWNhdGUuY2FsbCh0aGF0LCB2ID0gdGhpc1tpXSwgaSwgdGhpcykpIHtcclxuXHQgICAgICAgICAgICAgICAgICAgICBvdGhlci5wdXNoKHYpO1xyXG5cdCAgICAgICAgICAgICAgICAgfVxyXG5cdCAgICAgICAgICAgICB9XHJcblx0ICAgICAgICAgICAgIHJldHVybiBvdGhlcjtcclxuXHQgICAgICAgICB9XHJcblx0ICk7XHJcblx0IFxyXG5cdCAvKipcclxuXHQgICogc2hpbSBmb3IgYXJyYXkuaW5kZXhPZlxyXG5cdCAgKlxyXG5cdCAgKiBAZnVuY3Rpb24gYXJyYXlfaW5kZXhPZlxyXG5cdCAgKiBAZXhhbXBsZVxyXG5cdCAgKiAgYGBgXHJcblx0ICAqICAgICAgdmFyIGFyciA9IFsyLDMsNF07XHJcblx0ICAqICAgICAgdmFyIHJlc3VsdCA9IGFycmF5VXRpbHMuaW5kZXhPZihhcnIsIDMpO1xyXG5cdCAgKiAgICAgIGNvbnNvbGUubG9nKHJlc3VsdCk7XHJcblx0ICAqICBgYGBcclxuXHQgICogICAgKnJlc3VsdDogMSpcclxuXHQgICogQHR5cGUge0Z1bmN0aW9ufVxyXG5cdCAgKiBAcHJpdmF0ZVxyXG5cdCAgKi9cclxuXHQgdmFyIGFycmF5X2luZGV4T2YgPSB1bmN1cnJ5VGhpcyhnZXRGdW5jTmF0aXZlKEFycmF5LnByb3RvdHlwZS5pbmRleE9mKSB8fFxyXG5cdCAgICAgZnVuY3Rpb24gKHNlYXJjaEVsZW1lbnQsIGZyb21JbmRleCkge1xyXG5cdCAgICAgICAgIHZhciBrO1xyXG5cdCBcclxuXHQgICAgICAgICBpZiAoIXRoaXMgfHwgIXRoaXMubGVuZ3RoKSB7Ly9lc2xpbnQtZGlzYWJsZS1saW5lIG5vLWludmFsaWQtdGhpc1xyXG5cdCAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiXFxcInRoaXNcXFwiIGlzIG51bGwgb3Igbm90IGRlZmluZWRcIik7XHJcblx0ICAgICAgICAgfVxyXG5cdCBcclxuXHQgICAgICAgICB2YXIgTyA9IE9iamVjdCh0aGlzKTsvL2VzbGludC1kaXNhYmxlLWxpbmUgbm8taW52YWxpZC10aGlzXHJcblx0IFxyXG5cdCAgICAgICAgIHZhciBsZW4gPSBPLmxlbmd0aCA+Pj4gMDtcclxuXHQgXHJcblx0ICAgICAgICAgaWYgKGxlbiA9PT0gMCkge1xyXG5cdCAgICAgICAgICAgICByZXR1cm4gLTE7XHJcblx0ICAgICAgICAgfVxyXG5cdCBcclxuXHQgICAgICAgICB2YXIgbiA9ICtmcm9tSW5kZXggfHwgMDtcclxuXHQgXHJcblx0ICAgICAgICAgaWYgKE1hdGguYWJzKG4pID09PSBJbmZpbml0eSkge1xyXG5cdCAgICAgICAgICAgICBuID0gMDtcclxuXHQgICAgICAgICB9XHJcblx0IFxyXG5cdCAgICAgICAgIGlmIChuID49IGxlbikge1xyXG5cdCAgICAgICAgICAgICByZXR1cm4gLTE7XHJcblx0ICAgICAgICAgfVxyXG5cdCBcclxuXHQgICAgICAgICBrID0gTWF0aC5tYXgobiA+PSAwID8gbiA6IGxlbiAtIE1hdGguYWJzKG4pLCAwKTtcclxuXHQgXHJcblx0ICAgICAgICAgd2hpbGUgKGsgPCBsZW4pIHtcclxuXHQgICAgICAgICAgICAgaWYgKGsgaW4gTyAmJiBPW2tdID09PSBzZWFyY2hFbGVtZW50KSB7XHJcblx0ICAgICAgICAgICAgICAgICByZXR1cm4gaztcclxuXHQgICAgICAgICAgICAgfVxyXG5cdCAgICAgICAgICAgICBrKys7XHJcblx0ICAgICAgICAgfVxyXG5cdCAgICAgICAgIHJldHVybiAtMTtcclxuXHQgICAgIH0pO1xyXG5cdCBcclxuXHQgLyoqXHJcblx0ICAqIGFycmF5IGZpbmQgc2hpbVxyXG5cdCAgKlxyXG5cdCAgKiBAZnVuY3Rpb24gYXJyYXlfZmluZFxyXG5cdCAgKiBAZXhhbXBsZVxyXG5cdCAgKiAgYGBgXHJcblx0ICAqICAgICAgdmFyIGFyciA9IFsyLDMsNF07XHJcblx0ICAqICAgICAgdmFyIHJlc3VsdCA9IGFycmF5VXRpbHMuZmluZChhcnIsIGZ1bmN0aW9uKGl0ZW0pe1xyXG5cdCAgICAgICAgICAqICAgICAgICAgIHJldHVybiBpdGVtICUgMiA9PT0gMDtcclxuXHQgICAgICAgICAgKiAgICAgIH0pO1xyXG5cdCAgKiAgICAgIGNvbnNvbGUubG9nKHJlc3VsdCk7XHJcblx0ICAqICBgYGBcclxuXHQgICogICAgKnJlc3VsdDogMipcclxuXHQgICogQHR5cGUge0Z1bmN0aW9ufVxyXG5cdCAgKiBAcHJpdmF0ZVxyXG5cdCAgKi9cclxuXHQgdmFyIGFycmF5X2ZpbmQgPSB1bmN1cnJ5VGhpcyhnZXRGdW5jTmF0aXZlKEFycmF5LnByb3RvdHlwZS5maW5kKSB8fFxyXG5cdCAgICAgZnVuY3Rpb24gKHByZWRpY2F0ZSwgdGhhdCkge1xyXG5cdCAgICAgICAgIHZhciBsZW5ndGggPSB0aGlzLmxlbmd0aDsvL2VzbGludC1kaXNhYmxlLWxpbmUgbm8taW52YWxpZC10aGlzXHJcblx0ICAgICAgICAgaWYgKHR5cGVvZiBwcmVkaWNhdGUgIT09IFwiZnVuY3Rpb25cIikge1xyXG5cdCAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQXJyYXkjZmluZDogcHJlZGljYXRlIG11c3QgYmUgYSBmdW5jdGlvblwiKTtcclxuXHQgICAgICAgICB9XHJcblx0ICAgICAgICAgaWYgKGxlbmd0aCA9PT0gMCkge1xyXG5cdCAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG5cdCAgICAgICAgIH1cclxuXHQgICAgICAgICBmb3IgKHZhciBpID0gMCwgdmFsdWU7IGkgPCBsZW5ndGg7IGkrKykge1xyXG5cdCAgICAgICAgICAgICB2YWx1ZSA9IHRoaXNbaV07Ly9lc2xpbnQtZGlzYWJsZS1saW5lIG5vLWludmFsaWQtdGhpc1xyXG5cdCAgICAgICAgICAgICBpZiAocHJlZGljYXRlLmNhbGwodGhhdCwgdmFsdWUsIGksIHRoaXMpKSB7XHJcblx0ICAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWU7XHJcblx0ICAgICAgICAgICAgIH1cclxuXHQgICAgICAgICB9XHJcblx0ICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuXHQgICAgIH1cclxuXHQgKTtcclxuXHQgXHJcblx0IHNoaW0ucmVkdWNlID0gYXJyYXlfcmVkdWNlO1xyXG5cdCBzaGltLm1hcCA9IGFycmF5X21hcDtcclxuXHQgc2hpbS5maWx0ZXIgPSBhcnJheV9maWx0ZXI7XHJcblx0IHNoaW0uaW5kZXhPZiA9IGFycmF5X2luZGV4T2Y7XHJcblx0IHNoaW0uZmluZCA9IGFycmF5X2ZpbmQ7XHJcblx0IFxyXG5cdCB2YXIgXyA9IHNoaW07IC8vZXNsaW50LWRpc2FibGUtbGluZSBuby11bnVzZWQtdmFyc1xyXG5cdCBleHBvcnRzLl8gID0gc2hpbTtcclxuXHJcblx0IHZhciBhdXRvZ2VuUmVnZXhwcyA9IFtcclxuXHQgICAgIC9cXGR7NCx9LyxcclxuXHQgICAgIC9eZW1iZXJcXGQrLyxcclxuXHQgICAgIC9eWzAtOV8tXSskLyxcclxuXHQgICAgIC9eX1xcZHsyLH0vLFxyXG5cdCAgICAgLyhbYS1mXy1dKlswLTlfLV0pezYsfS9pXHJcblx0IF07XHJcblx0IFxyXG5cdCAvKipcclxuXHQgICogY2hlY2sgYXV0by1nZW5lcmF0ZWQgc2VsZWN0b3JzXHJcblx0ICAqIEBwYXJhbSB7U3RyaW5nfSB2YWxcclxuXHQgICogQHJldHVybiB7Ym9vbGVhbn0gaXMgYXV0by1nZW5lcmF0ZWRcclxuXHQgICovXHJcblx0IGZ1bmN0aW9uIGF1dG9nZW5DaGVjayh2YWwpe1xyXG5cdCAgICAgaWYoIXZhbCl7XHJcblx0ICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG5cdCAgICAgfVxyXG5cdCAgICAgdmFyIGF1dG9nZW5lcmF0ZWQgPSBfLmZpbmQoYXV0b2dlblJlZ2V4cHMsZnVuY3Rpb24ocmVnKXtcclxuXHQgICAgICAgICByZXR1cm4gcmVnLnRlc3QodmFsKTtcclxuXHQgICAgIH0pO1xyXG5cdCAgICAgcmV0dXJuICEhYXV0b2dlbmVyYXRlZDtcclxuXHQgXHJcblx0IH1cclxuXHQgZXhwb3J0cy5hdXRvZ2VuQ2hlY2sgPSBhdXRvZ2VuQ2hlY2s7XHJcblx0IFxyXG5cclxuXHQgdmFyIGNzc0VzY2FwZXIgPSAoZnVuY3Rpb24oKXtcclxuXHQgICAgIC8qKlxyXG5cdCAgICAgICogQGZ1bmN0aW9uIGVzY2FwZUlkZW50aWZpZXJJZk5lZWRlZFxyXG5cdCAgICAgICogQHBhcmFtIHtzdHJpbmd9IGlkZW50XHJcblx0ICAgICAgKiBAcmV0dXJuIHtzdHJpbmd9XHJcblx0ICAgICAgKi9cclxuXHQgICAgIGZ1bmN0aW9uIGVzY2FwZUlkZW50aWZpZXJJZk5lZWRlZChpZGVudCkge1xyXG5cdCAgICAgICAgIGlmIChpc0Nzc0lkZW50aWZpZXIoaWRlbnQpKSB7XHJcblx0ICAgICAgICAgICAgIHJldHVybiBpZGVudDtcclxuXHQgICAgICAgICB9XHJcblx0ICAgICAgICAgdmFyIHNob3VsZEVzY2FwZUZpcnN0ID0gL14oPzpbMC05XXwtWzAtOS1dPykvLnRlc3QoaWRlbnQpO1xyXG5cdCAgICAgICAgIHZhciBsYXN0SW5kZXggPSBpZGVudC5sZW5ndGggLSAxO1xyXG5cdCAgICAgICAgIHJldHVybiBpZGVudC5yZXBsYWNlKC8uL2csIGZ1bmN0aW9uIChjLCBpKSB7XHJcblx0ICAgICAgICAgICAgIHJldHVybiAoKHNob3VsZEVzY2FwZUZpcnN0ICYmIGkgPT09IDApIHx8ICFpc0Nzc0lkZW50Q2hhcihjKSkgPyBlc2NhcGVBc2NpaUNoYXIoYywgaSA9PT0gbGFzdEluZGV4KSA6IGM7XHJcblx0ICAgICAgICAgfSk7XHJcblx0ICAgICB9XHJcblx0IFxyXG5cdCAgICAgLyoqXHJcblx0ICAgICAgKiBAZnVuY3Rpb24gZXNjYXBlQXNjaWlDaGFyXHJcblx0ICAgICAgKiBAcGFyYW0ge3N0cmluZ30gY1xyXG5cdCAgICAgICogQHBhcmFtIHtib29sZWFufSBpc0xhc3RcclxuXHQgICAgICAqIEByZXR1cm4ge3N0cmluZ31cclxuXHQgICAgICAqL1xyXG5cdCAgICAgZnVuY3Rpb24gZXNjYXBlQXNjaWlDaGFyKGMsIGlzTGFzdCkge1xyXG5cdCAgICAgICAgIHJldHVybiBcIlxcXFxcIiArIHRvSGV4Qnl0ZShjKSArIChpc0xhc3QgPyBcIlwiIDogXCIgXCIpO1xyXG5cdCAgICAgfVxyXG5cdCBcclxuXHQgICAgIC8qKlxyXG5cdCAgICAgICogQGZ1bmN0aW9uIHRvSGV4Qnl0ZVxyXG5cdCAgICAgICogQHBhcmFtIHtzdHJpbmd9IGNcclxuXHQgICAgICAqL1xyXG5cdCAgICAgZnVuY3Rpb24gdG9IZXhCeXRlKGMpIHtcclxuXHQgICAgICAgICB2YXIgaGV4Qnl0ZSA9IGMuY2hhckNvZGVBdCgwKS50b1N0cmluZygxNik7XHJcblx0ICAgICAgICAgaWYgKGhleEJ5dGUubGVuZ3RoID09PSAxKSB7XHJcblx0ICAgICAgICAgICAgIGhleEJ5dGUgPSBcIjBcIiArIGhleEJ5dGU7XHJcblx0ICAgICAgICAgfVxyXG5cdCAgICAgICAgIHJldHVybiBoZXhCeXRlO1xyXG5cdCAgICAgfVxyXG5cdCBcclxuXHQgICAgIC8qKlxyXG5cdCAgICAgICogQGZ1bmN0aW9uIGlzQ3NzSWRlbnRDaGFyXHJcblx0ICAgICAgKiBAcGFyYW0ge3N0cmluZ30gY1xyXG5cdCAgICAgICogQHJldHVybiB7Ym9vbGVhbn1cclxuXHQgICAgICAqL1xyXG5cdCAgICAgZnVuY3Rpb24gaXNDc3NJZGVudENoYXIoYykge1xyXG5cdCAgICAgICAgIGlmICgvW2EtekEtWjAtOV8tXS8udGVzdChjKSkge1xyXG5cdCAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuXHQgICAgICAgICB9XHJcblx0ICAgICAgICAgcmV0dXJuIGMuY2hhckNvZGVBdCgwKSA+PSAweEEwO1xyXG5cdCAgICAgfVxyXG5cdCBcclxuXHQgICAgIC8qKlxyXG5cdCAgICAgICogQGZ1bmN0aW9uIGlzQ3NzSWRlbnRpZmllclxyXG5cdCAgICAgICogQHBhcmFtIHtzdHJpbmd9IHZhbHVlXHJcblx0ICAgICAgKiBAcmV0dXJuIHtib29sZWFufVxyXG5cdCAgICAgICovXHJcblx0ICAgICBmdW5jdGlvbiBpc0Nzc0lkZW50aWZpZXIodmFsdWUpIHtcclxuXHQgICAgICAgICByZXR1cm4gL14tP1thLXpBLVpfXVthLXpBLVowLTlfLV0qJC8udGVzdCh2YWx1ZSk7XHJcblx0ICAgICB9XHJcblx0IFxyXG5cdCAgICAgcmV0dXJuIHtlc2NhcGUgOiBlc2NhcGVJZGVudGlmaWVySWZOZWVkZWR9O1xyXG5cdCBcclxuXHQgfSkoKTtcclxuXHQgXHJcblx0IGV4cG9ydHMuY3NzRXNjYXBlciA9IGNzc0VzY2FwZXI7XHJcblx0IFxyXG5cclxuXHQgLyoqXHJcblx0ICAqIEBjb25zdHJ1Y3RvclxyXG5cdCAgKiBAcGFyYW0ge3N0cmluZ30gdmFsdWVcclxuXHQgICogQHBhcmFtIHtib29sZWFufSBvcHRpbWl6ZWRcclxuXHQgICovXHJcblx0IHZhciBEb21Ob2RlUGF0aFN0ZXAgPSBmdW5jdGlvbiAodmFsdWUsIG9wdGltaXplZCkge1xyXG5cdCAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xyXG5cdCAgICAgdGhpcy5vcHRpbWl6ZWQgPSBvcHRpbWl6ZWQgfHwgZmFsc2U7XHJcblx0IH07XHJcblx0IFxyXG5cdCBEb21Ob2RlUGF0aFN0ZXAucHJvdG90eXBlID0ge1xyXG5cdCAgICAgLyoqXHJcblx0ICAgICAgKiBAcmV0dXJuIHtzdHJpbmd9XHJcblx0ICAgICAgKi9cclxuXHQgICAgIHRvU3RyaW5nOiBmdW5jdGlvbiAoKSB7XHJcblx0ICAgICAgICAgcmV0dXJuIHRoaXMudmFsdWU7XHJcblx0ICAgICB9XHJcblx0IH07XHJcblx0IFxyXG5cdCBleHBvcnRzLkRvbU5vZGVQYXRoU3RlcCA9IERvbU5vZGVQYXRoU3RlcDtcclxuXHQgXHJcblxyXG5cdCAvKiBnbG9iYWxzIERvbU5vZGVQYXRoU3RlcCwgY3NzRXNjYXBlciwgYXV0b2dlbkNoZWNrICovIC8vZXNsaW50LWRpc2FibGUtbGluZSBuby11bnVzZWQtdmFyc1xyXG5cdCAvKipcclxuXHQgICogQHBhcmFtIHtPYmplY3Q/fSBvcHRpb25zXHJcblx0ICAqIEBwYXJhbSB7Ym9vbGVhbj99IG9wdGlvbnMud2l0aG91dE50aENoaWxkXHJcblx0ICAqIEBwYXJhbSB7Ym9vbGVhbj99IG9wdGlvbnMub3B0aW1pemVkXHJcblx0ICAqIEBwYXJhbSB7Tm9kZT99IG9wdGlvbnMudGFyZ2V0Tm9kZVxyXG5cdCAgKiBAY2xhc3NcclxuXHQgICogQGNvbnN0cnVjdG9yXHJcblx0ICAqL1xyXG5cdCBmdW5jdGlvbiBTZWxlY3RvckdlbmVyYXRvclN0ZXAob3B0aW9ucykge1xyXG5cdCAgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge1xyXG5cdCAgICAgICAgICAgICB3aXRob3V0TnRoQ2hpbGQ6IGZhbHNlLFxyXG5cdCAgICAgICAgICAgICB0YXJnZXROb2RlOiBudWxsXHJcblx0ICAgICAgICAgfTtcclxuXHQgXHJcblx0ICAgICAvKipcclxuXHQgICAgICAqIGdlbmVyYXRlIHNlbGVjdG9yIGZvciBjdXJyZW50IG5vZGVcclxuXHQgICAgICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IG5vZGVcclxuXHQgICAgICAqIEByZXR1cm4ge0RvbU5vZGVQYXRoU3RlcH0gc2VsZWN0b3IgZm9yIGN1cnJlbnQgbm9kZVxyXG5cdCAgICAgICovXHJcblx0ICAgICB0aGlzLnZpc2l0ID0gZnVuY3Rpb24gKG5vZGUpIHtcclxuXHQgICAgICAgICBpZiAobm9kZS5ub2RlVHlwZSAhPT0gMSkge1xyXG5cdCAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuXHQgICAgICAgICB9XHJcblx0IFxyXG5cdCAgICAgICAgIHZhciBub2RlTmFtZSA9IG5vZGUubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtcclxuXHQgICAgICAgICB2YXIgcGFyZW50ID0gbm9kZS5wYXJlbnROb2RlO1xyXG5cdCAgICAgICAgIHZhciBzaWJsaW5ncyA9IHBhcmVudC5jaGlsZHJlbiB8fCBbXTtcclxuXHQgICAgICAgICB2YXIgc2libGluZ3NXaXRoU2FtZU5vZGVOYW1lID0gZ2V0U2libGluZ3NXaXRoU2FtZU5vZGVOYW1lKG5vZGUsIHNpYmxpbmdzKTtcclxuXHQgXHJcblx0ICAgICAgICAgdmFyIG5lZWRzSWQgPSBoYXNJZChub2RlLCBzaWJsaW5nc1dpdGhTYW1lTm9kZU5hbWUpO1xyXG5cdCAgICAgICAgIGlmIChuZWVkc0lkKSB7XHJcblx0ICAgICAgICAgICAgIHZhciBpZCA9IG5vZGUuZ2V0QXR0cmlidXRlKFwiaWRcIik7XHJcblx0ICAgICAgICAgICAgIHJldHVybiBuZXcgRG9tTm9kZVBhdGhTdGVwKG5vZGVOYW1lICsgaWRTZWxlY3RvcihpZCksIHRydWUpO1xyXG5cdCAgICAgICAgIH1cclxuXHQgICAgICAgICB2YXIgaXNSb290Tm9kZSA9ICFwYXJlbnQgfHwgcGFyZW50Lm5vZGVUeXBlID09PSA5O1xyXG5cdCAgICAgICAgIGlmIChpc1Jvb3ROb2RlKSAvLyBkb2N1bWVudCBub2RlXHJcblx0ICAgICAgICAge1xyXG5cdCAgICAgICAgICAgICByZXR1cm4gbmV3IERvbU5vZGVQYXRoU3RlcChub2RlTmFtZSwgdHJ1ZSk7XHJcblx0ICAgICAgICAgfVxyXG5cdCBcclxuXHQgICAgICAgICB2YXIgaGFzQXR0cmlidXRlTmFtZSA9IGhhc1VuaXF1ZUF0dHJpYnV0ZU5hbWUobm9kZSxzaWJsaW5nc1dpdGhTYW1lTm9kZU5hbWUpO1xyXG5cdCAgICAgICAgIHZhciBuZWVkc0NsYXNzTmFtZXMgPSBzaWJsaW5nc1dpdGhTYW1lTm9kZU5hbWUubGVuZ3RoID4gMDtcclxuXHQgICAgICAgICB2YXIgbmVlZHNOdGhDaGlsZCA9IGlzTmVlZHNOdGhDaGlsZChub2RlLCBzaWJsaW5nc1dpdGhTYW1lTm9kZU5hbWUsIGhhc0F0dHJpYnV0ZU5hbWUpO1xyXG5cdCAgICAgICAgIHZhciBuZWVkc1R5cGUgPSBoYXNUeXBlKG5vZGUpO1xyXG5cdCBcclxuXHQgICAgICAgICB2YXIgcmVzdWx0ID0gbm9kZU5hbWU7XHJcblx0IFxyXG5cdCAgICAgICAgIGlmIChoYXNBdHRyaWJ1dGVOYW1lKSB7XHJcblx0ICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGVOYW1lID0gbm9kZS5nZXRBdHRyaWJ1dGUoXCJuYW1lXCIpO1xyXG5cdCAgICAgICAgICAgICByZXN1bHQgKz0gXCJbbmFtZT1cXFwiXCIgKyBjc3NFc2NhcGVyLmVzY2FwZShhdHRyaWJ1dGVOYW1lKSArIFwiXFxcIl1cIjtcclxuXHQgICAgICAgICAgICAgcmV0dXJuIG5ldyBEb21Ob2RlUGF0aFN0ZXAocmVzdWx0LCB0cnVlKTtcclxuXHQgICAgICAgICB9XHJcblx0IFxyXG5cdCAgICAgICAgIGlmIChuZWVkc1R5cGUpIHtcclxuXHQgICAgICAgICAgICAgcmVzdWx0ICs9IFwiW3R5cGU9XFxcIlwiICsgbm9kZS5nZXRBdHRyaWJ1dGUoXCJ0eXBlXCIpICsgXCJcXFwiXVwiO1xyXG5cdCAgICAgICAgIH1cclxuXHQgXHJcblx0ICAgICAgICAgaWYgKG5lZWRzTnRoQ2hpbGQgJiYgIW9wdGlvbnMud2l0aG91dE50aENoaWxkKSB7XHJcblx0ICAgICAgICAgICAgIHZhciBvd25JbmRleCA9IF8uaW5kZXhPZihzaWJsaW5ncywgbm9kZSk7XHJcblx0ICAgICAgICAgICAgIHJlc3VsdCArPSBcIjpudGgtY2hpbGQoXCIgKyAob3duSW5kZXggKyAxKSArIFwiKVwiO1xyXG5cdCAgICAgICAgIH0gZWxzZSBpZiAobmVlZHNDbGFzc05hbWVzKSB7XHJcblx0ICAgICAgICAgICAgIHZhciBwcmVmaXhlZE93bkNsYXNzTmFtZXNBcnJheSA9IHByZWZpeGVkRWxlbWVudENsYXNzTmFtZXMobm9kZSk7XHJcblx0ICAgICAgICAgICAgIGZvciAodmFyIHByZWZpeGVkTmFtZSBpbiBrZXlTZXQocHJlZml4ZWRPd25DbGFzc05hbWVzQXJyYXkpKSB7IC8vZXNsaW50LWRpc2FibGUtbGluZSBndWFyZC1mb3ItaW5cclxuXHQgICAgICAgICAgICAgICAgIHJlc3VsdCArPSBcIi5cIiArIGNzc0VzY2FwZXIuZXNjYXBlKHByZWZpeGVkTmFtZS5zdWJzdHIoMSkpO1xyXG5cdCAgICAgICAgICAgICB9XHJcblx0ICAgICAgICAgfVxyXG5cdCBcclxuXHQgICAgICAgICByZXR1cm4gbmV3IERvbU5vZGVQYXRoU3RlcChyZXN1bHQsIGZhbHNlKTtcclxuXHQgICAgIH07XHJcblx0IFxyXG5cdCAgICAgZnVuY3Rpb24gaGFzVW5pcXVlQXR0cmlidXRlTmFtZShub2RlLCBzaWJsaW5nc1dpdGhTYW1lTm9kZU5hbWUpe1xyXG5cdCAgICAgICAgIHZhciBhdHRyaWJ1dGVOYW1lID0gbm9kZS5nZXRBdHRyaWJ1dGUoXCJuYW1lXCIpO1xyXG5cdCAgICAgICAgIGlmKCFhdHRyaWJ1dGVOYW1lIHx8IGF1dG9nZW5DaGVjayhhdHRyaWJ1dGVOYW1lKSl7XHJcblx0ICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuXHQgICAgICAgICB9XHJcblx0ICAgICAgICAgdmFyIGlzU2ltcGxlRm9ybUVsZW1lbnQgPSBpc1NpbXBsZUlucHV0KG5vZGUsIG9wdGlvbnMudGFyZ2V0Tm9kZSA9PT0gbm9kZSkgfHwgaXNGb3JtV2l0aG91dElkKG5vZGUpO1xyXG5cdCAgICAgICAgIHJldHVybiAhIShpc1NpbXBsZUZvcm1FbGVtZW50ICYmIGF0dHJpYnV0ZU5hbWUgJiYgIV8uZmluZChzaWJsaW5nc1dpdGhTYW1lTm9kZU5hbWUsZnVuY3Rpb24oc2libGluZyl7XHJcblx0ICAgICAgICAgICAgIHJldHVybiBzaWJsaW5nLmdldEF0dHJpYnV0ZShcIm5hbWVcIikgPT09IGF0dHJpYnV0ZU5hbWU7XHJcblx0ICAgICAgICAgfSkpO1xyXG5cdCAgICAgfVxyXG5cdCBcclxuXHQgICAgIGZ1bmN0aW9uIGlzTmVlZHNOdGhDaGlsZChub2RlLCBzaWJsaW5ncywgaXNVbmlxdWVBdHRyaWJ1dGVOYW1lKSB7XHJcblx0ICAgICAgICAgdmFyIG5lZWRzTnRoQ2hpbGQgPSBmYWxzZTtcclxuXHQgICAgICAgICB2YXIgcHJlZml4ZWRPd25DbGFzc05hbWVzQXJyYXkgPSBwcmVmaXhlZEVsZW1lbnRDbGFzc05hbWVzKG5vZGUpO1xyXG5cdCAgICAgICAgIGZvciAodmFyIGkgPSAwOyAoIW5lZWRzTnRoQ2hpbGQpICYmIGkgPCBzaWJsaW5ncy5sZW5ndGg7ICsraSkge1xyXG5cdCAgICAgICAgICAgICB2YXIgc2libGluZyA9IHNpYmxpbmdzW2ldO1xyXG5cdCAgICAgICAgICAgICBpZiAobmVlZHNOdGhDaGlsZCkge1xyXG5cdCAgICAgICAgICAgICAgICAgY29udGludWU7XHJcblx0ICAgICAgICAgICAgIH1cclxuXHQgXHJcblx0ICAgICAgICAgICAgIHZhciBvd25DbGFzc05hbWVzID0ga2V5U2V0KHByZWZpeGVkT3duQ2xhc3NOYW1lc0FycmF5KTtcclxuXHQgICAgICAgICAgICAgdmFyIG93bkNsYXNzTmFtZUNvdW50ID0gMDtcclxuXHQgXHJcblx0ICAgICAgICAgICAgIGZvciAodmFyIG5hbWUgaW4gb3duQ2xhc3NOYW1lcykge1xyXG5cdCAgICAgICAgICAgICAgICAgaWYgKG93bkNsYXNzTmFtZXMuaGFzT3duUHJvcGVydHkobmFtZSkpIHtcclxuXHQgICAgICAgICAgICAgICAgICAgICArK293bkNsYXNzTmFtZUNvdW50O1xyXG5cdCAgICAgICAgICAgICAgICAgfVxyXG5cdCAgICAgICAgICAgICB9XHJcblx0ICAgICAgICAgICAgIGlmIChvd25DbGFzc05hbWVDb3VudCA9PT0gMCAmJiAhaXNVbmlxdWVBdHRyaWJ1dGVOYW1lKSB7XHJcblx0ICAgICAgICAgICAgICAgICBuZWVkc050aENoaWxkID0gdHJ1ZTtcclxuXHQgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG5cdCAgICAgICAgICAgICB9XHJcblx0ICAgICAgICAgICAgIHZhciBzaWJsaW5nQ2xhc3NOYW1lc0FycmF5ID0gcHJlZml4ZWRFbGVtZW50Q2xhc3NOYW1lcyhzaWJsaW5nKTtcclxuXHQgXHJcblx0ICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2libGluZ0NsYXNzTmFtZXNBcnJheS5sZW5ndGg7ICsraikge1xyXG5cdCAgICAgICAgICAgICAgICAgdmFyIHNpYmxpbmdDbGFzcyA9IHNpYmxpbmdDbGFzc05hbWVzQXJyYXlbal07XHJcblx0ICAgICAgICAgICAgICAgICBpZiAoIW93bkNsYXNzTmFtZXMuaGFzT3duUHJvcGVydHkoc2libGluZ0NsYXNzKSkge1xyXG5cdCAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG5cdCAgICAgICAgICAgICAgICAgfVxyXG5cdCAgICAgICAgICAgICAgICAgZGVsZXRlIG93bkNsYXNzTmFtZXNbc2libGluZ0NsYXNzXTtcclxuXHQgICAgICAgICAgICAgICAgIGlmICghLS1vd25DbGFzc05hbWVDb3VudCAmJiAhaXNVbmlxdWVBdHRyaWJ1dGVOYW1lKSB7XHJcblx0ICAgICAgICAgICAgICAgICAgICAgbmVlZHNOdGhDaGlsZCA9IHRydWU7XHJcblx0ICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcblx0ICAgICAgICAgICAgICAgICB9XHJcblx0ICAgICAgICAgICAgIH1cclxuXHQgICAgICAgICB9XHJcblx0ICAgICAgICAgcmV0dXJuIG5lZWRzTnRoQ2hpbGQ7XHJcblx0ICAgICB9XHJcblx0IFxyXG5cdCAgICAgZnVuY3Rpb24gZ2V0U2libGluZ3NXaXRoU2FtZU5vZGVOYW1lKG5vZGUsIHNpYmxpbmdzKSB7XHJcblx0ICAgICAgICAgcmV0dXJuIF8uZmlsdGVyKHNpYmxpbmdzLCBmdW5jdGlvbiAoc2libGluZykge1xyXG5cdCAgICAgICAgICAgICByZXR1cm4gc2libGluZy5ub2RlVHlwZSA9PT0gMSAmJiBzaWJsaW5nICE9PSBub2RlICYmIHNpYmxpbmcubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gbm9kZS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpO1xyXG5cdCAgICAgICAgIH0pO1xyXG5cdCAgICAgfVxyXG5cdCBcclxuXHQgICAgIGZ1bmN0aW9uIGhhc1R5cGUobm9kZSkge1xyXG5cdCAgICAgICAgIHJldHVybiBub2RlLmdldEF0dHJpYnV0ZShcInR5cGVcIikgJiYgKCAoaXNTaW1wbGVJbnB1dChub2RlLCBvcHRpb25zLnRhcmdldE5vZGUgPT09IG5vZGUpICYmICFnZXRDbGFzc05hbWUobm9kZSkpIHx8IGlzRm9ybVdpdGhvdXRJZChub2RlKSB8fCBpc0J1dHRvbldpdGhvdXRJZChub2RlKSk7XHJcblx0ICAgICB9XHJcblx0IFxyXG5cdCAgICAgLyoqXHJcblx0ICAgICAgKiBAZnVuY3Rpb24gaWRTZWxlY3RvclxyXG5cdCAgICAgICogQHBhcmFtIHtzdHJpbmd9IGlkXHJcblx0ICAgICAgKiBAcmV0dXJuIHtzdHJpbmd9XHJcblx0ICAgICAgKi9cclxuXHQgICAgIGZ1bmN0aW9uIGlkU2VsZWN0b3IoaWQpIHtcclxuXHQgICAgICAgICByZXR1cm4gXCIjXCIgKyBjc3NFc2NhcGVyLmVzY2FwZShpZCk7XHJcblx0ICAgICB9XHJcblx0IFxyXG5cdCAgICAgLyoqXHJcblx0ICAgICAgKiBlbGVtZW50IGhhcyBzaWJsaW5ncyB3aXRoIHNhbWUgaWQgYW5kIHNhbWUgdGFnXHJcblx0ICAgICAgKiBAZnVuY3Rpb24gaGFzSWRcclxuXHQgICAgICAqIEBwYXJhbSB7RWxlbWVudH0gbm9kZVxyXG5cdCAgICAgICogQHBhcmFtIHtBcnJheTxFbGVtZW50Pn0gc2libGluZ3MgQXJyYXkgb2YgZWxlbWVudHMgLCBwYXJlbnQuY2hpbGRyZW5cclxuXHQgICAgICAqIEByZXR1cm4ge2Jvb2xlYW59XHJcblx0ICAgICAgKi9cclxuXHQgICAgIGZ1bmN0aW9uIGhhc0lkKG5vZGUsIHNpYmxpbmdzKSB7XHJcblx0ICAgICAgICAgdmFyIGlkID0gbm9kZS5nZXRBdHRyaWJ1dGUoXCJpZFwiKTtcclxuXHQgICAgICAgICBpZighaWQpe1xyXG5cdCAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcblx0ICAgICAgICAgfVxyXG5cdCAgICAgICAgIGlmKGF1dG9nZW5DaGVjayhpZCkpe1xyXG5cdCAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcblx0ICAgICAgICAgfVxyXG5cdCAgICAgICAgIHJldHVybiBfLmZpbHRlcihzaWJsaW5ncywgZnVuY3Rpb24gKHMpIHtcclxuXHQgICAgICAgICAgICAgICAgIHJldHVybiBzLmdldEF0dHJpYnV0ZShcImlkXCIpID09PSBpZDtcclxuXHQgICAgICAgICAgICAgfSkubGVuZ3RoID09PSAwO1xyXG5cdCAgICAgfVxyXG5cdCBcclxuXHQgICAgIC8qKlxyXG5cdCAgICAgICogQGZ1bmN0aW9uIGtleVNldFxyXG5cdCAgICAgICogQHBhcmFtIHtBcnJheX0gYXJyYXkgb2Yga2V5c1xyXG5cdCAgICAgICogQHJldHVybiB7T2JqZWN0fVxyXG5cdCAgICAgICovXHJcblx0ICAgICBmdW5jdGlvbiBrZXlTZXQoYXJyYXkpIHtcclxuXHQgICAgICAgICB2YXIga2V5cyA9IHt9O1xyXG5cdCAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJyYXkubGVuZ3RoOyArK2kpIHtcclxuXHQgICAgICAgICAgICAga2V5c1thcnJheVtpXV0gPSB0cnVlO1xyXG5cdCAgICAgICAgIH1cclxuXHQgICAgICAgICByZXR1cm4ga2V5cztcclxuXHQgICAgIH1cclxuXHQgXHJcblx0ICAgICAvKipcclxuXHQgICAgICAqIEBmdW5jdGlvbiBwcmVmaXhlZEVsZW1lbnRDbGFzc05hbWVzXHJcblx0ICAgICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSBub2RlXHJcblx0ICAgICAgKiBAcmV0dXJuIHshQXJyYXkuPHN0cmluZz59XHJcblx0ICAgICAgKi9cclxuXHQgICAgIGZ1bmN0aW9uIHByZWZpeGVkRWxlbWVudENsYXNzTmFtZXMobm9kZSkge1xyXG5cdCAgICAgICAgIHZhciBjbGFzc0F0dHJpYnV0ZSA9IGdldENsYXNzTmFtZShub2RlKTtcclxuXHQgICAgICAgICBpZiAoIWNsYXNzQXR0cmlidXRlKSB7XHJcblx0ICAgICAgICAgICAgIHJldHVybiBbXTtcclxuXHQgICAgICAgICB9XHJcblx0IFxyXG5cdCAgICAgICAgIHZhciBjbGFzc2VzID0gY2xhc3NBdHRyaWJ1dGUuc3BsaXQoL1xccysvZyk7XHJcblx0ICAgICAgICAgdmFyIGV4aXN0Q2xhc3NlcyA9IF8uZmlsdGVyKGNsYXNzZXMsIGZ1bmN0aW9uKGMpe1xyXG5cdCAgICAgICAgICAgICByZXR1cm4gYyAmJiAhYXV0b2dlbkNoZWNrKGMpO1xyXG5cdCAgICAgICAgIH0pO1xyXG5cdCAgICAgICAgIHJldHVybiBfLm1hcChleGlzdENsYXNzZXMsIGZ1bmN0aW9uIChuYW1lKSB7XHJcblx0ICAgICAgICAgICAgIC8vIFRoZSBwcmVmaXggaXMgcmVxdWlyZWQgdG8gc3RvcmUgXCJfX3Byb3RvX19cIiBpbiBhIG9iamVjdC1iYXNlZCBtYXAuXHJcblx0ICAgICAgICAgICAgIHJldHVybiBcIiRcIiArIG5hbWU7XHJcblx0ICAgICAgICAgfSk7XHJcblx0ICAgICB9XHJcblx0IFxyXG5cdCAgICAgZnVuY3Rpb24gaXNGb3JtV2l0aG91dElkKG5vZGUpIHtcclxuXHQgICAgICAgICByZXR1cm4gbm9kZS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpID09PSBcImZvcm1cIiAmJiAhbm9kZS5nZXRBdHRyaWJ1dGUoXCJpZFwiKTtcclxuXHQgICAgIH1cclxuXHQgXHJcblx0ICAgICBmdW5jdGlvbiBpc0J1dHRvbldpdGhvdXRJZChub2RlKSB7XHJcblx0ICAgICAgICAgcmV0dXJuIG5vZGUubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gXCJidXR0b25cIiAmJiAhbm9kZS5nZXRBdHRyaWJ1dGUoXCJpZFwiKTtcclxuXHQgICAgIH1cclxuXHQgXHJcblx0ICAgICAvKipcclxuXHQgICAgICAqIHRhcmdldCBpcyBzaW1wbGUgaW5wdXQgd2l0aG91dCBjbGFzc2VzLGlkXHJcblx0ICAgICAgKiBAZnVuY3Rpb24gaXNTaW1wbGVJbnB1dFxyXG5cdCAgICAgICogQHBhcmFtIG5vZGVcclxuXHQgICAgICAqIEBwYXJhbSBpc1RhcmdldE5vZGVcclxuXHQgICAgICAqIEByZXR1cm4ge2Jvb2xlYW59XHJcblx0ICAgICAgKi9cclxuXHQgICAgIGZ1bmN0aW9uIGlzU2ltcGxlSW5wdXQobm9kZSwgaXNUYXJnZXROb2RlKSB7XHJcblx0ICAgICAgICAgcmV0dXJuIGlzVGFyZ2V0Tm9kZSAmJiBub2RlLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgPT09IFwiaW5wdXRcIiA7XHJcblx0ICAgICB9XHJcblx0IFxyXG5cdCAgICAgLyoqXHJcblx0ICAgICAgKiBAZnVuY3Rpb24gZ2V0Q2xhc3NOYW1lXHJcblx0ICAgICAgKiBnZXQgY3NzIGNsYXNzIG9mIGVsZW1lbnRcclxuXHQgICAgICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IG5vZGUgV2ViIGVsZW1lbnRcclxuXHQgICAgICAqIEByZXR1cm4ge3N0cmluZ31cclxuXHQgICAgICAqL1xyXG5cdCAgICAgZnVuY3Rpb24gZ2V0Q2xhc3NOYW1lKG5vZGUpIHtcclxuXHQgICAgICAgICByZXR1cm4gbm9kZS5nZXRBdHRyaWJ1dGUoXCJjbGFzc1wiKSB8fCBub2RlLmNsYXNzTmFtZTtcclxuXHQgICAgIH1cclxuXHQgXHJcblx0IH1cclxuXHQgXHJcblx0IGV4cG9ydHMuU2VsZWN0b3JHZW5lcmF0b3JTdGVwID0gU2VsZWN0b3JHZW5lcmF0b3JTdGVwO1xyXG5cdCBcclxuXHJcblx0IC8qZ2xvYmFsICBTZWxlY3RvckdlbmVyYXRvclN0ZXAgKi8gLy9lc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVudXNlZC12YXJzXHJcblx0IC8qKlxyXG5cdCAgKiBAY2xhc3NcclxuXHQgICogZ2V0IHVuaXF1ZSBzZWxlY3RvciwgcGF0aCBvZiBub2RlXHJcblx0ICAqIEBwYXJhbSB7T2JqZWN0P30gb3B0aW9uc1xyXG5cdCAgKiBAcGFyYW0ge2Z1bmN0aW9uP30gb3B0aW9ucy5xdWVyeVNlbGVjdG9yQWxsXHJcblx0ICAqIEBjb25zdHJ1Y3RvclxyXG5cdCAgKi9cclxuXHQgZnVuY3Rpb24gU2VsZWN0b3JHZW5lcmF0b3Iob3B0aW9ucykgeyAvL2VzbGludC1kaXNhYmxlLWxpbmUgbm8tdW51c2VkLXZhcnNcclxuXHQgXHJcblx0ICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcclxuXHQgXHJcblx0ICAgICAvKipcclxuXHQgICAgICAqIEBkZXNjcmlwdGlvbiBnZXQgZnVsbCBwYXRoIG9mIG5vZGVcclxuXHQgICAgICAqIEBmdW5jdGlvbiBnZXRQYXRoXHJcblx0ICAgICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSBub2RlXHJcblx0ICAgICAgKiBAcmV0dXJuIHtzdHJpbmd9XHJcblx0ICAgICAgKi9cclxuXHQgICAgIGZ1bmN0aW9uIGdldFBhdGgobm9kZSkge1xyXG5cdCAgICAgICAgIGlmICghbm9kZSB8fCBub2RlLm5vZGVUeXBlICE9PSAxKSB7XHJcblx0ICAgICAgICAgICAgIHJldHVybiBcIlwiO1xyXG5cdCAgICAgICAgIH1cclxuXHQgICAgICAgICB2YXIgc2VsZWN0b3JHZW5lcmF0b3JTdGVwID0gbmV3IFNlbGVjdG9yR2VuZXJhdG9yU3RlcCh7XHJcblx0ICAgICAgICAgICAgIHdpdGhvdXROdGhDaGlsZDogdHJ1ZSxcclxuXHQgICAgICAgICAgICAgdGFyZ2V0Tm9kZTogbm9kZVxyXG5cdCAgICAgICAgIH0pO1xyXG5cdCAgICAgICAgIHZhciBzdGVwcyA9IFtdO1xyXG5cdCAgICAgICAgIHZhciBjb250ZXh0Tm9kZSA9IG5vZGU7XHJcblx0ICAgICAgICAgd2hpbGUgKGNvbnRleHROb2RlKSB7XHJcblx0ICAgICAgICAgICAgIHZhciBzdGVwID0gc2VsZWN0b3JHZW5lcmF0b3JTdGVwLnZpc2l0KGNvbnRleHROb2RlKTtcclxuXHQgICAgICAgICAgICAgaWYgKCFzdGVwKSB7XHJcblx0ICAgICAgICAgICAgICAgICBicmVhaztcclxuXHQgICAgICAgICAgICAgfSAvLyBFcnJvciAtIGJhaWwgb3V0IGVhcmx5LlxyXG5cdCAgICAgICAgICAgICBzdGVwcy5wdXNoKHN0ZXApO1xyXG5cdCAgICAgICAgICAgICBjb250ZXh0Tm9kZSA9IGNvbnRleHROb2RlLnBhcmVudE5vZGU7XHJcblx0ICAgICAgICAgfVxyXG5cdCBcclxuXHQgICAgICAgICBzdGVwcy5yZXZlcnNlKCk7XHJcblx0ICAgICAgICAgcmV0dXJuIHN0ZXBzLmpvaW4oXCIgXCIpO1xyXG5cdCAgICAgfVxyXG5cdCBcclxuXHQgICAgIC8qKlxyXG5cdCAgICAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gbm9kZVxyXG5cdCAgICAgICogQHJldHVybiB7c3RyaW5nfVxyXG5cdCAgICAgICovXHJcblx0ICAgICBmdW5jdGlvbiBnZXRTZWxlY3Rvcihub2RlKSB7XHJcblx0ICAgICAgICAgaWYgKCFub2RlIHx8IG5vZGUubm9kZVR5cGUgIT09IDEpIHtcclxuXHQgICAgICAgICAgICAgcmV0dXJuIFwiXCI7XHJcblx0ICAgICAgICAgfVxyXG5cdCAgICAgICAgIHZhciBzZWxlY3RvckdlbmVyYXRvclN0ZXAgPSBuZXcgU2VsZWN0b3JHZW5lcmF0b3JTdGVwKHt0YXJnZXROb2RlOiBub2RlfSk7XHJcblx0ICAgICAgICAgdmFyIHN0ZXBzID0gW107XHJcblx0ICAgICAgICAgdmFyIGNvbnRleHROb2RlID0gbm9kZTtcclxuXHQgICAgICAgICB3aGlsZSAoY29udGV4dE5vZGUpIHtcclxuXHQgICAgICAgICAgICAgdmFyIHN0ZXAgPSBzZWxlY3RvckdlbmVyYXRvclN0ZXAudmlzaXQoY29udGV4dE5vZGUpO1xyXG5cdCAgICAgICAgICAgICBpZiAoIXN0ZXApIHtcclxuXHQgICAgICAgICAgICAgICAgIGJyZWFrOyAvLyBFcnJvciAtIGJhaWwgb3V0IGVhcmx5LlxyXG5cdCAgICAgICAgICAgICB9XHJcblx0ICAgICAgICAgICAgIHN0ZXBzLnB1c2goc3RlcCk7XHJcblx0ICAgICAgICAgICAgIGlmIChzdGVwLm9wdGltaXplZCkge1xyXG5cdCAgICAgICAgICAgICAgICAgaWYgKGlzVW5pcXVlU2VsZWN0b3IoYnVpbGRTZWxlY3RvcihzdGVwcykpKSB7XHJcblx0ICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcblx0ICAgICAgICAgICAgICAgICB9XHJcblx0ICAgICAgICAgICAgIH1cclxuXHQgICAgICAgICAgICAgY29udGV4dE5vZGUgPSBjb250ZXh0Tm9kZS5wYXJlbnROb2RlO1xyXG5cdCAgICAgICAgIH1cclxuXHQgXHJcblx0ICAgICAgICAgdmFyIHNpbXBsaWZpZWRTdGVwcyA9IHNpbXBsaWZ5U2VsZWN0b3Ioc3RlcHMpO1xyXG5cdCAgICAgICAgIHJldHVybiBidWlsZFNlbGVjdG9yKHNpbXBsaWZpZWRTdGVwcyk7XHJcblx0ICAgICB9XHJcblx0IFxyXG5cdCAgICAgLyoqXHJcblx0ICAgICAgKiBzaW1wbGlmeSBzZWxlY3RvclxyXG5cdCAgICAgICogQGV4YW1wbGVcclxuXHQgICAgICAqIGBgYFxyXG5cdCAgICAgICogIDxkaXY+XHJcblx0ICAgICAgKiAgICAgIDxkaXY+XHJcblx0ICAgICAgKiAgICAgICAgICA8Zm9ybT5cclxuXHQgICAgICAqICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1cInRleHRcIi8+XHJcblx0ICAgICAgKiAgICAgICAgICA8L2Zvcm0+XHJcblx0ICAgICAgKiAgICAgIDwvZGl2PlxyXG5cdCAgICAgICogIDwvZGl2PlxyXG5cdCAgICAgICpcclxuXHQgICAgICAqIHZhciBzdGVwcyA9IFtuZXcgRG9tTm9kZVBhdGhTdGVwKFwiaW5wdXRbdHlwZT0ndGV4dCddXCIpLCBuZXcgRG9tTm9kZVBhdGhTdGVwKFwiZm9ybVwiKSwgbmV3IERvbU5vZGVQYXRoU3RlcChcImRpdlwiKSwgbmV3IERvbU5vZGVQYXRoU3RlcChcImRpdlwiKV07XHJcblx0ICAgICAgKiB2YXIgc2ltcGxpZmllZCA9IHNpbXBsaWZ5U2VsZWN0b3Ioc3RlcHMpOyAvLyBbXCJpbnB1dFt0eXBlPSd0ZXh0J11cIiwgXCJmb3JtXCJdXHJcblx0ICAgICAgKiBgYGBcclxuXHQgICAgICAqXHJcblx0ICAgICAgKiBAZXhhbXBsZVxyXG5cdCAgICAgICogYGBgXHJcblx0ICAgICAgKiAgPGRpdiBpZD1cImxvZ2luRm9ybVwiPlxyXG5cdCAgICAgICogICAgICA8ZGl2PlxyXG5cdCAgICAgICogICAgICAgICAgPGRpdj5cclxuXHQgICAgICAqICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1cInRleHRcIi8+XHJcblx0ICAgICAgKiAgICAgICAgICA8L2Rpdj5cclxuXHQgICAgICAqICAgICAgPC9kaXY+XHJcblx0ICAgICAgKiAgPC9kaXY+XHJcblx0ICAgICAgKlxyXG5cdCAgICAgICogdmFyIHN0ZXBzID0gW25ldyBEb21Ob2RlUGF0aFN0ZXAoXCJpbnB1dFt0eXBlPSd0ZXh0J11cIiksIG5ldyBEb21Ob2RlUGF0aFN0ZXAoXCJkaXZcIiksIG5ldyBEb21Ob2RlUGF0aFN0ZXAoXCJkaXZcIiksIG5ldyBEb21Ob2RlUGF0aFN0ZXAoXCJkaXYjbG9naW5Gb3JtXCIpXTtcclxuXHQgICAgICAqIHZhciBzaW1wbGlmaWVkID0gc2ltcGxpZnlTZWxlY3RvcihzdGVwcyk7IC8vIFtbXCJpbnB1dFt0eXBlPSd0ZXh0J11cIl0sW1wiZGl2I2xvZ2luRm9ybVwiXV1cclxuXHQgICAgICAqIGBgYFxyXG5cdCAgICAgICpcclxuXHQgICAgICAqIEBtZXRob2Qgc2ltcGxpZnlTZWxlY3RvclxyXG5cdCAgICAgICogQHBhcmFtIHtBcnJheX0gc3RlcHMgcGFydHMgb2Ygc2VsZWN0b3JcclxuXHQgICAgICAqIEByZXR1cm4ge0FycmF5fSBzdGVwcyBhcnJheSBvZiBzdGVwcyBvciBhcnJheSBBcnJheXMgb2Ygc3RlcHNcclxuXHQgICAgICAqL1xyXG5cdCAgICAgZnVuY3Rpb24gc2ltcGxpZnlTZWxlY3RvcihzdGVwcykge1xyXG5cdCAgICAgICAgIHZhciBtaW5MZW5ndGggPSAyO1xyXG5cdCAgICAgICAgIC8vaWYgY291bnQgb2Ygc2VsZWN0b3JzIGlzIGxpdHRsZSwgdGhhdCBub3QgbW9kaWZ5IHNlbGVjdG9yXHJcblx0ICAgICAgICAgaWYgKHN0ZXBzLmxlbmd0aCA8PSBtaW5MZW5ndGgpIHtcclxuXHQgICAgICAgICAgICAgcmV0dXJuIHN0ZXBzO1xyXG5cdCAgICAgICAgIH1cclxuXHQgXHJcblx0ICAgICAgICAgdmFyIHN0ZXBzQ29weSA9IHN0ZXBzLnNsaWNlKCk7XHJcblx0ICAgICAgICAgcmVtb3ZlSHRtbEJvZHlTdGVwcyhzdGVwc0NvcHkpO1xyXG5cdCBcclxuXHQgICAgICAgICB2YXIgbGFzdFN0ZXAgPSBzdGVwc0NvcHlbc3RlcHNDb3B5Lmxlbmd0aCAtIDFdO1xyXG5cdCAgICAgICAgIHZhciBwYXJlbnRXaXRoSWQgPSBsYXN0U3RlcC50b1N0cmluZygpLmluZGV4T2YoXCIjXCIpID49IDA7XHJcblx0ICAgICAgICAgdmFyIHBhcmVudFdpdGhOYW1lID0gbGFzdFN0ZXAudG9TdHJpbmcoKS5pbmRleE9mKFwibmFtZT1cIikgPj0gMDtcclxuXHQgXHJcblx0ICAgICAgICAgaWYgKHBhcmVudFdpdGhJZCB8fCBwYXJlbnRXaXRoTmFtZSkge1xyXG5cdCAgICAgICAgICAgICByZXR1cm4gc2ltcGxpZnlTdGVwc1dpdGhQYXJlbnQoc3RlcHNDb3B5KTtcclxuXHQgICAgICAgICB9IGVsc2Uge1xyXG5cdCAgICAgICAgICAgICByZXR1cm4gcmVndWxhclNpbXBsaWZ5U3RlcHMoc3RlcHNDb3B5LCBtaW5MZW5ndGgpO1xyXG5cdCAgICAgICAgIH1cclxuXHQgICAgIH1cclxuXHQgXHJcblx0ICAgICAvKipcclxuXHQgICAgICAqIHJlbW92ZSBIdG1sLCBCb2R5IFN0ZXBzXHJcblx0ICAgICAgKiBAcGFyYW0gc3RlcHNcclxuXHQgICAgICAqL1xyXG5cdCAgICAgZnVuY3Rpb24gcmVtb3ZlSHRtbEJvZHlTdGVwcyhzdGVwcykge1xyXG5cdCAgICAgICAgIHdoaWxlIChzdGVwc1tzdGVwcy5sZW5ndGggLSAxXS50b1N0cmluZygpID09PSBcImh0bWxcIiB8fCBzdGVwc1tzdGVwcy5sZW5ndGggLSAxXS50b1N0cmluZygpID09PSBcImJvZHlcIikge1xyXG5cdCAgICAgICAgICAgICBzdGVwcy5wb3AoKTtcclxuXHQgICAgICAgICB9XHJcblx0ICAgICB9XHJcblx0IFxyXG5cdCAgICAgLyoqXHJcblx0ICAgICAgKiAgc2ltcGxpZnlTdGVwc1dpdGhQYXJlbnRcclxuXHQgICAgICAqIEBmdW5jdGlvbiBzaW1wbGlmeVN0ZXBzV2l0aFBhcmVudFxyXG5cdCAgICAgICogQHBhcmFtIHN0ZXBzXHJcblx0ICAgICAgKiBAcmV0dXJuIHtBcnJheX0gYXJyYXkgb2YgYXJyYXlzXHJcblx0ICAgICAgKi9cclxuXHQgICAgIGZ1bmN0aW9uIHNpbXBsaWZ5U3RlcHNXaXRoUGFyZW50KHN0ZXBzKSB7XHJcblx0ICAgICAgICAgdmFyIHBhcmVudFN0ZXAgPSBzdGVwcy5zbGljZSgtMSk7XHJcblx0ICAgICAgICAgdmFyIHNsaWNlZCA9IHN0ZXBzLnNsaWNlKDAsIDEpO1xyXG5cdCAgICAgICAgIHdoaWxlIChzbGljZWQubGVuZ3RoIDwgKHN0ZXBzLmxlbmd0aCAtIDEpKSB7XHJcblx0ICAgICAgICAgICAgIHZhciBzZWxlY3RvciA9IGJ1aWxkU2VsZWN0b3IoW3NsaWNlZCwgcGFyZW50U3RlcF0pO1xyXG5cdCAgICAgICAgICAgICBpZiAoaXNVbmlxdWVTZWxlY3RvcihzZWxlY3RvcikpIHtcclxuXHQgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cdCAgICAgICAgICAgICB9XHJcblx0ICAgICAgICAgICAgIHNsaWNlZCA9IHN0ZXBzLnNsaWNlKDAsIHNsaWNlZC5sZW5ndGggKyAxKTtcclxuXHQgICAgICAgICB9XHJcblx0ICAgICAgICAgcmV0dXJuIFtzbGljZWQsIHBhcmVudFN0ZXBdO1xyXG5cdCAgICAgfVxyXG5cdCBcclxuXHQgICAgIC8qKlxyXG5cdCAgICAgICogcmVndWxhclNpbXBsaWZ5U3RlcHNcclxuXHQgICAgICAqIEBtZXRob2QgcmVndWxhclNpbXBsaWZ5U3RlcHNcclxuXHQgICAgICAqIEBwYXJhbSB7QXJyYXl9IHN0ZXBzXHJcblx0ICAgICAgKiBAcGFyYW0ge2ludD0yfSBtaW5MZW5ndGhcclxuXHQgICAgICAqIEByZXR1cm4ge0FycmF5fSBhcnJheSBvZiBzdGVwc1xyXG5cdCAgICAgICovXHJcblx0ICAgICBmdW5jdGlvbiByZWd1bGFyU2ltcGxpZnlTdGVwcyhzdGVwcywgbWluTGVuZ3RoKSB7XHJcblx0ICAgICAgICAgbWluTGVuZ3RoID0gbWluTGVuZ3RoIHx8IDI7XHJcblx0ICAgICAgICAgdmFyIHNsaWNlZCA9IHN0ZXBzLnNsaWNlKDAsIG1pbkxlbmd0aCk7XHJcblx0ICAgICAgICAgd2hpbGUgKHNsaWNlZC5sZW5ndGggPCBzdGVwcy5sZW5ndGgpIHtcclxuXHQgICAgICAgICAgICAgdmFyIHNlbGVjdG9yID0gYnVpbGRTZWxlY3RvcihzbGljZWQpO1xyXG5cdCAgICAgICAgICAgICBpZiAoaXNVbmlxdWVTZWxlY3RvcihzZWxlY3RvcikpIHtcclxuXHQgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cdCAgICAgICAgICAgICB9XHJcblx0ICAgICAgICAgICAgIHNsaWNlZCA9IHN0ZXBzLnNsaWNlKDAsIHNsaWNlZC5sZW5ndGggKyAxKTtcclxuXHQgICAgICAgICB9XHJcblx0ICAgICAgICAgcmV0dXJuIHNsaWNlZDtcclxuXHQgICAgIH1cclxuXHQgXHJcblx0ICAgICAvKipcclxuXHQgICAgICAqIGNyZWF0ZSBzZWxlY3RvciBzdHJpbmcgZnJvbSBzdGVwcyBhcnJheVxyXG5cdCAgICAgICogQGZ1bmN0aW9uIGJ1aWxkU2VsZWN0b3JcclxuXHQgICAgICAqIEBleGFtcGxlXHJcblx0ICAgICAgKiB3aXRoIHNpbmdsZSBhcnJheSBvZiBzdGVwc1xyXG5cdCAgICAgICogYGBgXHJcblx0ICAgICAgKiA8Zm9ybSBpZD1cImxvZ2luRm9ybVwiPlxyXG5cdCAgICAgICogICAgPGlucHV0IHR5cGU9J3RleHQnLz5cclxuXHQgICAgICAqIDwvZm9ybT5cclxuXHQgICAgICAqXHJcblx0ICAgICAgKiAgdmFyIHN0ZXBzID0gW25ldyBEb21Ob2RlUGF0aFN0ZXAoXCJpbnB1dFt0eXBlPSd0ZXh0J11cIiksbmV3IERvbU5vZGVQYXRoU3RlcChcImZvcm0jbG9naW5Gb3JtXCIpXTtcclxuXHQgICAgICAqICB2YXIgc2VsZWN0b3IgPSBidWlsZFNlbGVjdG9yKHN0ZXBzKTsgLy8gXCJmb3JtI2xvZ2luRm9ybSA+IGlucHV0W3R5cGU9J3RleHQnXVwiXHJcblx0ICAgICAgKiBgYGBcclxuXHQgICAgICAqXHJcblx0ICAgICAgKiBAZXhhbXBsZVxyXG5cdCAgICAgICogd2l0aCBtdWx0aXBsZSBhcnJheSBvZiBzdGVwc1xyXG5cdCAgICAgICogYGBgXHJcblx0ICAgICAgKiA8ZGl2IGlkPVwibG9naW5Gb3JtXCI+XHJcblx0ICAgICAgKiAgICA8ZGl2PlxyXG5cdCAgICAgICogICAgICAgPGRpdj5cclxuXHQgICAgICAqICAgICAgICAgIDxpbnB1dCB0eXBlPSd0ZXh0Jy8+XHJcblx0ICAgICAgKiAgICAgIDwvZGl2PlxyXG5cdCAgICAgICogICA8L2Rpdj5cclxuXHQgICAgICAqICA8L2Rpdj5cclxuXHQgICAgICAqXHJcblx0ICAgICAgKiB2YXIgc3RlcHMgPSBbW25ldyBEb21Ob2RlUGF0aFN0ZXAoXCJpbnB1dFt0eXBlPSd0ZXh0J11cIildLFtuZXcgRG9tTm9kZVBhdGhTdGVwKFwiZGl2I2xvZ2luRm9ybVwiKV1dO1xyXG5cdCAgICAgICogdmFyIHNlbGVjdG9yID0gYnVpbGRTZWxlY3RvcihzdGVwcyk7IC8vIFwiZGl2I2xvZ2luRm9ybSBpbnB1dFt0eXBlPSd0ZXh0J11cIlxyXG5cdCAgICAgICogYGBgXHJcblx0ICAgICAgKlxyXG5cdCAgICAgICogQHBhcmFtIHtBcnJheX0gc3RlcHMgQXJyYXkgb2Ygc3RyaW5nIG9yIGFycmF5IG9mIEFycmF5IG9mIHN0cmluZ1xyXG5cdCAgICAgICogQHJldHVybiB7c3RyaW5nfSBzZWxlY3RvciBzdHJpbmdcclxuXHQgICAgICAqL1xyXG5cdCAgICAgZnVuY3Rpb24gYnVpbGRTZWxlY3RvcihzdGVwcykge1xyXG5cdCAgICAgICAgIHZhciBzdGVwc0NvcHkgPSBzdGVwcy5zbGljZSgpO1xyXG5cdCAgICAgICAgIHN0ZXBzQ29weS5yZXZlcnNlKCk7XHJcblx0ICAgICAgICAgLy9jaGVjayBzdGVwcyBpcyByZWd1bGFyIGFycmF5IG9mIHN0ZXBzXHJcblx0ICAgICAgICAgaWYgKHR5cGVvZihzdGVwc0NvcHlbMF0udmFsdWUpICE9PSBcInVuZGVmaW5lZFwiKSB7XHJcblx0ICAgICAgICAgICAgIHJldHVybiBzdGVwc0NvcHkuam9pbihcIiA+IFwiKTtcclxuXHQgICAgICAgICB9IGVsc2Uge1xyXG5cdCAgICAgICAgICAgICByZXR1cm4gXy5yZWR1Y2Uoc3RlcHNDb3B5LCBmdW5jdGlvbiAocHJldmlvc1ZhbHVlLCBjdXJyZW50VmFsdWUpIHtcclxuXHQgICAgICAgICAgICAgICAgIHZhciBzZWxlY3RvciA9IGJ1aWxkU2VsZWN0b3IoY3VycmVudFZhbHVlKTtcclxuXHQgICAgICAgICAgICAgICAgIHJldHVybiBwcmV2aW9zVmFsdWUgPyBwcmV2aW9zVmFsdWUgKyBcIiBcIiArIHNlbGVjdG9yIDogc2VsZWN0b3I7XHJcblx0ICAgICAgICAgICAgIH0sIFwiXCIpO1xyXG5cdCAgICAgICAgIH1cclxuXHQgICAgIH1cclxuXHQgXHJcblx0ICAgICAvKipcclxuXHQgICAgICAqIEBmdW5jdGlvbiBpc1VuaXF1ZVNlbGVjdG9yXHJcblx0ICAgICAgKiBkZXRlY3Qgc2VsZWN0b3IgaXMgdW5pcXVlXHJcblx0ICAgICAgKiBAcGFyYW0ge1N0cmluZ30gc2VsZWN0b3JcclxuXHQgICAgICAqIEByZXR1cm4ge2Jvb2xlYW59IHVuaXF1ZSBzZWxlY3Rvcj9cclxuXHQgICAgICAqL1xyXG5cdCAgICAgZnVuY3Rpb24gaXNVbmlxdWVTZWxlY3RvcihzZWxlY3Rvcikge1xyXG5cdCAgICAgICAgIGlmICghb3B0aW9ucy5xdWVyeVNlbGVjdG9yQWxsKSB7XHJcblx0ICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG5cdCAgICAgICAgIH1cclxuXHQgICAgICAgICByZXR1cm4gb3B0aW9ucy5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKS5sZW5ndGggPCAyO1xyXG5cdCAgICAgfVxyXG5cdCBcclxuXHQgICAgIC8qKlxyXG5cdCAgICAgICogZ2V0IHVuaXF1ZSBzZWxlY3RvclxyXG5cdCAgICAgICogQG1ldGhvZFxyXG5cdCAgICAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gbm9kZSBodG1sIGVsZW1lbnRcclxuXHQgICAgICAqIEBwYXJhbSB7Ym9vbGVhbj99IG9wdGltaXplZCBnZXQgc2hvcnQgc2VsZWN0b3JcclxuXHQgICAgICAqIEByZXR1cm5zIHtTdHJpbmd9IHNlbGVjdG9yXHJcblx0ICAgICAgKi9cclxuXHQgICAgIHRoaXMuZ2V0U2VsZWN0b3IgPSBnZXRTZWxlY3RvcjtcclxuXHQgICAgIC8qKlxyXG5cdCAgICAgICogcGF0aCBvZiBub2RlXHJcblx0ICAgICAgKiBAbWV0aG9kXHJcblx0ICAgICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSBub2RlIGh0bWwgZWxlbWVudFxyXG5cdCAgICAgICogQHJldHVybnMge1N0cmluZ30gcGF0aFxyXG5cdCAgICAgICovXHJcblx0ICAgICB0aGlzLmdldFBhdGggPSBnZXRQYXRoO1xyXG5cdCB9XHJcblx0IFxyXG5cdCBleHBvcnRzLlNlbGVjdG9yR2VuZXJhdG9yID0gU2VsZWN0b3JHZW5lcmF0b3I7XHJcblxyXG4gIHJldHVybiBuZXcgU2VsZWN0b3JHZW5lcmF0b3Iob3B0aW9ucyk7XHJcbiB9XHJcbiAgZXhwb3J0cy5TZWxlY3RvckdlbmVyYXRvciA9IFNlbGVjdG9yR2VuZXJhdG9yO1xyXG4gfSAoZXhwb3J0cykpO1xyXG5cclxuZm9yKHZhciBrZXkgaW4gZXhwb3J0cyl7IGlmKGV4cG9ydHMuaGFzT3duUHJvcGVydHkoa2V5KSl7IGV4cG9ydHMuU2VsZWN0b3JHZW5lcmF0b3Jba2V5XSA9IGV4cG9ydHNba2V5XTsgfX1cclxuIHdpbmRvdy5TZWxlY3RvckdlbmVyYXRvciA9IGV4cG9ydHMuU2VsZWN0b3JHZW5lcmF0b3I7XHJcblxyXG59ICgpKTtcclxuXHJcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/selector-generator/selector-generator.js\n");

/***/ }),

/***/ "./src/index.ts":
/*!**********************!*\
  !*** ./src/index.ts ***!
  \**********************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.initListener = exports.initObserver = void 0;\n__webpack_require__(/*! selector-generator */ \"./node_modules/selector-generator/selector-generator.js\");\nfunction initObserver() {\n    sendAllDOM();\n    var generator = new SelectorGenerator();\n    var serializer = new XMLSerializer();\n    var targetNode = document.getElementById('root');\n    var config = { attributes: true, childList: true, subtree: true };\n    var callback = function (mutationsList, observer) {\n        for (var _i = 0, mutationsList_1 = mutationsList; _i < mutationsList_1.length; _i++) {\n            var mutation = mutationsList_1[_i];\n            if (mutation.type === 'childList') {\n                console.log('mutation', mutation);\n                var selector = generator.getSelector(mutation.target);\n                var htmlString = serializer.serializeToString(mutation.target);\n                sendMessage({\n                    operation: 'add',\n                    selector: selector,\n                    htmlString: htmlString,\n                });\n            }\n            else if (mutation.type === 'attributes') {\n                console.log('The ' + mutation.attributeName + ' attribute was modified.');\n            }\n        }\n    };\n    var observer = new MutationObserver(callback);\n    observer.observe(targetNode, config);\n}\nexports.initObserver = initObserver;\nfunction sendAllDOM() {\n    var serializer = new XMLSerializer();\n    var selector = '#root';\n    var element = document.querySelector(selector);\n    var htmlString = serializer.serializeToString(element);\n    sendMessage({ operation: 'add', htmlString: htmlString, selector: selector });\n}\nfunction update(_a) {\n    var htmlString = _a.htmlString, selector = _a.selector, operation = _a.operation;\n    var element = document.querySelector(selector);\n    if (!element) {\n        throw Error('element not found');\n    }\n    console.log('UPDATER:', operation);\n    switch (operation) {\n        case 'add':\n            element.innerHTML = '';\n            element.insertAdjacentHTML('afterbegin', htmlString);\n        case 'remove':\n    }\n}\nfunction initListener() {\n    window.addEventListener('message', function (event) {\n        console.log('Updater - Receive event: ', event.data);\n        update(event.data);\n    });\n}\nexports.initListener = initListener;\nfunction sendMessage(_a) {\n    var operation = _a.operation, selector = _a.selector, htmlString = _a.htmlString;\n    console.log('sendMessage', operation, selector, htmlString);\n    window.parent.postMessage({\n        operation: operation,\n        htmlString: htmlString,\n        selector: selector,\n    }, '*');\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvaW5kZXgudHMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9Ccm93c2VyU2hhcmluZy8uL3NyYy9pbmRleC50cz8yYWNmIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZXhwb3J0cy5pbml0TGlzdGVuZXIgPSBleHBvcnRzLmluaXRPYnNlcnZlciA9IHZvaWQgMDtcbnJlcXVpcmUoXCJzZWxlY3Rvci1nZW5lcmF0b3JcIik7XG5mdW5jdGlvbiBpbml0T2JzZXJ2ZXIoKSB7XG4gICAgc2VuZEFsbERPTSgpO1xuICAgIHZhciBnZW5lcmF0b3IgPSBuZXcgU2VsZWN0b3JHZW5lcmF0b3IoKTtcbiAgICB2YXIgc2VyaWFsaXplciA9IG5ldyBYTUxTZXJpYWxpemVyKCk7XG4gICAgdmFyIHRhcmdldE5vZGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncm9vdCcpO1xuICAgIHZhciBjb25maWcgPSB7IGF0dHJpYnV0ZXM6IHRydWUsIGNoaWxkTGlzdDogdHJ1ZSwgc3VidHJlZTogdHJ1ZSB9O1xuICAgIHZhciBjYWxsYmFjayA9IGZ1bmN0aW9uIChtdXRhdGlvbnNMaXN0LCBvYnNlcnZlcikge1xuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIG11dGF0aW9uc0xpc3RfMSA9IG11dGF0aW9uc0xpc3Q7IF9pIDwgbXV0YXRpb25zTGlzdF8xLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIG11dGF0aW9uID0gbXV0YXRpb25zTGlzdF8xW19pXTtcbiAgICAgICAgICAgIGlmIChtdXRhdGlvbi50eXBlID09PSAnY2hpbGRMaXN0Jykge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdtdXRhdGlvbicsIG11dGF0aW9uKTtcbiAgICAgICAgICAgICAgICB2YXIgc2VsZWN0b3IgPSBnZW5lcmF0b3IuZ2V0U2VsZWN0b3IobXV0YXRpb24udGFyZ2V0KTtcbiAgICAgICAgICAgICAgICB2YXIgaHRtbFN0cmluZyA9IHNlcmlhbGl6ZXIuc2VyaWFsaXplVG9TdHJpbmcobXV0YXRpb24udGFyZ2V0KTtcbiAgICAgICAgICAgICAgICBzZW5kTWVzc2FnZSh7XG4gICAgICAgICAgICAgICAgICAgIG9wZXJhdGlvbjogJ2FkZCcsXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdG9yOiBzZWxlY3RvcixcbiAgICAgICAgICAgICAgICAgICAgaHRtbFN0cmluZzogaHRtbFN0cmluZyxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKG11dGF0aW9uLnR5cGUgPT09ICdhdHRyaWJ1dGVzJykge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdUaGUgJyArIG11dGF0aW9uLmF0dHJpYnV0ZU5hbWUgKyAnIGF0dHJpYnV0ZSB3YXMgbW9kaWZpZWQuJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHZhciBvYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKGNhbGxiYWNrKTtcbiAgICBvYnNlcnZlci5vYnNlcnZlKHRhcmdldE5vZGUsIGNvbmZpZyk7XG59XG5leHBvcnRzLmluaXRPYnNlcnZlciA9IGluaXRPYnNlcnZlcjtcbmZ1bmN0aW9uIHNlbmRBbGxET00oKSB7XG4gICAgdmFyIHNlcmlhbGl6ZXIgPSBuZXcgWE1MU2VyaWFsaXplcigpO1xuICAgIHZhciBzZWxlY3RvciA9ICcjcm9vdCc7XG4gICAgdmFyIGVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKTtcbiAgICB2YXIgaHRtbFN0cmluZyA9IHNlcmlhbGl6ZXIuc2VyaWFsaXplVG9TdHJpbmcoZWxlbWVudCk7XG4gICAgc2VuZE1lc3NhZ2UoeyBvcGVyYXRpb246ICdhZGQnLCBodG1sU3RyaW5nOiBodG1sU3RyaW5nLCBzZWxlY3Rvcjogc2VsZWN0b3IgfSk7XG59XG5mdW5jdGlvbiB1cGRhdGUoX2EpIHtcbiAgICB2YXIgaHRtbFN0cmluZyA9IF9hLmh0bWxTdHJpbmcsIHNlbGVjdG9yID0gX2Euc2VsZWN0b3IsIG9wZXJhdGlvbiA9IF9hLm9wZXJhdGlvbjtcbiAgICB2YXIgZWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3IpO1xuICAgIGlmICghZWxlbWVudCkge1xuICAgICAgICB0aHJvdyBFcnJvcignZWxlbWVudCBub3QgZm91bmQnKTtcbiAgICB9XG4gICAgY29uc29sZS5sb2coJ1VQREFURVI6Jywgb3BlcmF0aW9uKTtcbiAgICBzd2l0Y2ggKG9wZXJhdGlvbikge1xuICAgICAgICBjYXNlICdhZGQnOlxuICAgICAgICAgICAgZWxlbWVudC5pbm5lckhUTUwgPSAnJztcbiAgICAgICAgICAgIGVsZW1lbnQuaW5zZXJ0QWRqYWNlbnRIVE1MKCdhZnRlcmJlZ2luJywgaHRtbFN0cmluZyk7XG4gICAgICAgIGNhc2UgJ3JlbW92ZSc6XG4gICAgfVxufVxuZnVuY3Rpb24gaW5pdExpc3RlbmVyKCkge1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdVcGRhdGVyIC0gUmVjZWl2ZSBldmVudDogJywgZXZlbnQuZGF0YSk7XG4gICAgICAgIHVwZGF0ZShldmVudC5kYXRhKTtcbiAgICB9KTtcbn1cbmV4cG9ydHMuaW5pdExpc3RlbmVyID0gaW5pdExpc3RlbmVyO1xuZnVuY3Rpb24gc2VuZE1lc3NhZ2UoX2EpIHtcbiAgICB2YXIgb3BlcmF0aW9uID0gX2Eub3BlcmF0aW9uLCBzZWxlY3RvciA9IF9hLnNlbGVjdG9yLCBodG1sU3RyaW5nID0gX2EuaHRtbFN0cmluZztcbiAgICBjb25zb2xlLmxvZygnc2VuZE1lc3NhZ2UnLCBvcGVyYXRpb24sIHNlbGVjdG9yLCBodG1sU3RyaW5nKTtcbiAgICB3aW5kb3cucGFyZW50LnBvc3RNZXNzYWdlKHtcbiAgICAgICAgb3BlcmF0aW9uOiBvcGVyYXRpb24sXG4gICAgICAgIGh0bWxTdHJpbmc6IGh0bWxTdHJpbmcsXG4gICAgICAgIHNlbGVjdG9yOiBzZWxlY3RvcixcbiAgICB9LCAnKicpO1xufVxuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/index.ts\n");

/***/ }),

/***/ 0:
/*!****************************!*\
  !*** multi ./src/index.ts ***!
  \****************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__(/*! ./src/index.ts */"./src/index.ts");


/***/ })

/******/ });
});